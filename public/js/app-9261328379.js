function nonEnumKeys(e){var t=e,n=Object.getOwnPropertyNames(t),i=Object.keys(t),o=n.filter(function(e){var t=i.indexOf(e);return-1==t});return o}function BunnyFormData(e){if(!(e instanceof HTMLFormElement))throw new Error("Form passed to BunnyFormData constructor is not an instance of HTMLFormElement");this._form=e,this._collection={};for(var t=this.getInputs(),n=0;n<t.length;n++){var i=t[n];this._initSingleInput(i)}}function simulateEvent(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=document.createEventObject?document.createEventObject():document.createEvent("Events");i.initEvent&&i.initEvent(t,!0,!0);for(var o in n)i[o]=n[o];e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+t,i)}function simulateKeydown(e,t){var n=["keydown","keypress, keyup"],i={keyCode:t,which:t};n.forEach(function(t){simulateEvent(e,t,i)})}function simulateAutocompleteSelect(e,t){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2],i=new Promise(function(i){e.value=t,setTimeout(function(){e.focus(),simulateEvent(e,"input"),setTimeout(function(){simulateKeydown(e,KEY_ARROW_DOWN),simulateKeydown(e,KEY_ENTER),e.blur(),setTimeout(function(){i()},300*n)},800*n)},800*n)});return i}function Filter(e){this._categoriesName="categories",this._dateName="dateselect",this._formId=e,this._form=document.forms[e],this._searchInput=document.forms[e].elements.search,this._categoriesCustomInput=this.getCustomInput(this._categoriesName),this._dateCustomInput=this.getCustomInput(this._dateName)}var babelHelpers={};babelHelpers["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},babelHelpers.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),babelHelpers.defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},function(e){"undefined"!=typeof module&&"object"==("undefined"==typeof exports?"undefined":babelHelpers["typeof"](exports))?"undefined"!=typeof window?module.exports=e():module.exports=e:window.Alert=e()}(function(e){var t=function(e){this.btn="object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))?e:document.querySelector(e),this.alert=null,this.duration=150,this.init()};t.prototype={init:function(){this.actions(),document.addEventListener("click",this.close,!1)},actions:function(){var e=this;this.close=function(t){var n=t.target;e.btn="alert"===n.getAttribute("data-dismiss")&&"close"===n.className?n:n.parentNode,e.alert=e.btn.parentNode,null!==e.alert&&"alert"===e.btn.getAttribute("data-dismiss")&&/in/.test(e.alert.className)&&(e.alert.className=e.alert.className.replace(" in",""),setTimeout(function(){e.alert&&e.alert.parentNode.removeChild(e.alert)},e.duration))}}};var n=document.querySelectorAll('[data-dismiss="alert"]'),i=0,o=n.length;for(i;o>i;i++)new t(n[i]);return t}),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof window.CustomEvent?!1:(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}(),function(){void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var e=/function\s([^(]{1,})\(/,t=e.exec(this.toString());return t&&t.length>1?t[1].trim():""},set:function(e){}})}(),function(e){function t(){}function n(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!==babelHelpers["typeof"](this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function o(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void u(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?r:a)(t.promise,e._value);var i;try{i=n(e._value)}catch(o){return void a(t.promise,o)}r(t.promise,i)}))}function r(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===("undefined"==typeof t?"undefined":babelHelpers["typeof"](t))||"function"==typeof t)){var o=t.then;if(t instanceof i)return e._state=3,e._value=t,void s(e);if("function"==typeof o)return void c(n(o,t),e)}e._state=1,e._value=t,s(e)}catch(r){a(e,r)}}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&u(function(){e._handled||h(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)o(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,r(t,e))},function(e){n||(n=!0,a(t,e))})}catch(i){if(n)return;n=!0,a(t,i)}}var d=setTimeout,u="function"==typeof setImmediate&&setImmediate||function(e){d(e,0)},h=function(e){"undefined"!=typeof console&&console};i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var i=new this.constructor(t);return o(this,new l(e,n,i)),i},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function i(r,a){try{if(a&&("object"===("undefined"==typeof a?"undefined":babelHelpers["typeof"](a))||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){i(r,e)},n)}t[r]=a,0===--o&&e(t)}catch(l){n(l)}}if(0===t.length)return e([]);for(var o=t.length,r=0;r<t.length;r++)i(r,t[r])})},i.resolve=function(e){return e&&"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var i=0,o=e.length;o>i;i++)e[i].then(t,n)})},i._setImmediateFn=function(e){u=e},i._setUnhandledRejectionFn=function(e){h=e},"undefined"!=typeof module&&module.exports?module.exports=i:e.Promise||(e.Promise=i)}(this),NodeList.prototype.forEach=Array.prototype.forEach,HTMLCollection.prototype.forEach=Array.prototype.forEach,Object.create=function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(Array.isArray(e))var n=[];else var n={};for(var i=Object.keys(e),o=0;o<i.length;o++){var r=i[o];e[r]&&"object"===babelHelpers["typeof"](e[r])&&"[object Function]"!==Object.prototype.toString.call(e[r])?e[r].nodeType&&"cloneNode"in e[r]?n[r]=e[r]:e[r]instanceof Date?n[r]=new Date(e[r].getTime()):e[r]instanceof RegExp?n[r]=new RegExp(e[r]):"object"===babelHelpers["typeof"](e[r])?n[r]=Object.create(e[r]):n[r]=e[r]:n[r]=e[r]}return null!==t&&Object.defineProperties(n,t),n},function(){window.KEY_BACKSPACE=8,window.KEY_TAB=9,window.KEY_ENTER=13,window.KEY_SHIFT=16,window.KEY_CTRL=17,window.KEY_ALT=18,window.KEY_ESCAPE=27,window.KEY_PAGE_UP=33,window.KEY_PAGE_DOWN=34,window.KEY_ARROW_LEFT=37,window.KEY_ARROW_UP=38,window.KEY_ARROW_RIGHT=39,window.KEY_ARROW_DOWN=40,window.KEY_DELETE=46}();var Dropdown={_collection:{},init:function(e){e=this._elOrId(e),void 0!==e.id&&(this._collection[e.id]=e);var t=this.getDropdownToggleBtn(e);null!==t&&(this._makeUnclosableInside(e),this._attachToggleClickEvent(e),this._attachToggleBtnMethods(e))},_elOrId:function(e){return"string"==typeof e?document.getElementById(e):e},_attachToggleClickEvent:function(e){var t=this;this.getDropdownToggleBtn(e).addEventListener("click",function(n){n.stopPropagation(),t.toggle(e)})},get:function(e){return this._collection[e]},getDropdownToggleBtn:function(e){return e=this._elOrId(e),e.querySelector('[data-toggle="dropdown"]')},getDropdownMenu:function(e){return e=this._elOrId(e),e.getElementsByClassName("dropdown-menu")[0]},isClosableInside:function(e){return e.hasAttribute("data-close-inside")},_makeUnclosableInside:function(e){this.isClosableInside(e)&&this.getDropdownMenu(e).addEventListener("click",function(e){e.stopPropagation()})},_getCloseEvent:function(e){return new CustomEvent("close",{detail:{dropdown:e}})},_getOpenEvent:function(e){return new CustomEvent("open",{detail:{dropdown:e}})},_bodyHandler:function(e){e.classList.contains("open")&&this.close(e)},_getUniqueBodyHandler:function(e){return void 0===e._bodyHandler&&(e._bodyHandler=this._bodyHandler.bind(this,e)),e._bodyHandler},close:function(e){e=this._elOrId(e),e.classList.remove("open"),document.body.removeEventListener("click",this._getUniqueBodyHandler(e)),this.getDropdownToggleBtn(e).dispatchEvent(this._getCloseEvent(e))},_attachToggleBtnMethods:function(e){var t=this.getDropdownToggleBtn(e);t.close=function(){this.close(e)},t.open=function(){this.open(e)},t.toggle=function(){this.toggle(e)}},open:function(e){e=this._elOrId(e),e.classList.add("open"),document.body.addEventListener("click",this._getUniqueBodyHandler(e)),this.getDropdownToggleBtn(e).dispatchEvent(this._getOpenEvent(e))},toggle:function(e){e=this._elOrId(e),e.classList.contains("open")?this.close(e):this.open(e)}};document.getElementsByClassName("dropdown").forEach(function(e){Dropdown.init(e)}),function(){function e(e){return 0!==e.indexOf("/")&&(e="/"+e),Server.app.localePrefix+e}function t(t){window.location=e(t)}window.url=e,window.redirect=t}(),function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):t("object"===("undefined"==typeof exports?"undefined":babelHelpers["typeof"](exports))&&"string"!=typeof exports.nodeName?exports:e.commonJsStrict={})}(this,function(e){function t(e){if(e in U)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=O.length;n--;)if(e=O[n]+t,e in U)return e}function n(e,t){e=e||{};for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},arguments.callee(e[n],t[n])):e[n]=t[n];return e}function i(e,t,n){var i;return function(){var o=this,r=arguments,a=function(){i=null,n||e.apply(o,r)},s=n&&!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(o,r)}}function o(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function r(e,t,n){if("string"==typeof t){var i=t;t={},t[i]=n}for(var o in t)e.style[o]=t[o]}function a(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function s(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")}function l(e,t){var n,i=t||new Image;return i.src===e?n=new Promise(function(e,t){e(i)}):(n=new Promise(function(t,n){"http"===e.substring(0,4).toLowerCase()&&i.setAttribute("crossOrigin","anonymous"),i.onload=function(){setTimeout(function(){t(i)},1)}}),i.src=e),i.style.opacity=0,n}function c(e,t){window.EXIF||t(0),EXIF.getData(e,function(){var e=EXIF.getTag(this,"Orientation");t(e)})}function d(e,t,n){var i=t.width,o=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:e.width=o,e.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,o),r.scale(1,-1);break;case 8:e.width=o,e.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,i,o),r.restore()}function u(){var e,t,n,i,o=this,s="croppie-container",l=o.options.viewport.type?"cr-vp-"+o.options.viewport.type:null;o.options.useCanvas=o.options.enableOrientation||h.call(o),o.data={},o.elements={},e=o.elements.boundary=document.createElement("div"),n=o.elements.viewport=document.createElement("div"),t=o.elements.img=document.createElement("img"),i=o.elements.overlay=document.createElement("div"),o.options.useCanvas?(o.elements.canvas=document.createElement("canvas"),o.elements.preview=o.elements.canvas):o.elements.preview=o.elements.img,a(e,"cr-boundary"),r(e,{width:o.options.boundary.width+"px",height:o.options.boundary.height+"px"}),a(n,"cr-viewport"),l&&a(n,l),r(n,{width:o.options.viewport.width+"px",height:o.options.viewport.height+"px"}),a(o.elements.preview,"cr-image"),a(i,"cr-overlay"),o.element.appendChild(e),e.appendChild(o.elements.preview),e.appendChild(n),e.appendChild(i),a(o.element,s),o.options.customClass&&a(o.element,o.options.customClass),y.call(this),o.options.enableZoom&&p.call(o)}function h(){return(this.options.enableExif||this.options.exif)&&window.EXIF}function m(e){this.options.enableZoom&&(this.elements.zoomer.value=x(e,4))}function p(){function e(){f.call(n,{value:parseFloat(o.value),origin:new Y(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:$.parse(n.elements.preview)})}function t(t){var i,o;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0,o=n._currentZoom+i,t.preventDefault(),m.call(n,o),e()}var n=this,i=n.elements.zoomerWrap=document.createElement("div"),o=n.elements.zoomer=document.createElement("input");a(i,"cr-slider-wrap"),a(o,"cr-slider"),o.type="range",o.step="0.01",o.value=1,o.style.display=n.options.showZoomer?"":"none",n.element.appendChild(i),i.appendChild(o),n._currentZoom=1,n.elements.zoomer.addEventListener("input",e),n.elements.zoomer.addEventListener("change",e),n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",t),n.elements.boundary.addEventListener("DOMMouseScroll",t))}function f(e){var t=this,n=e?e.transform:$.parse(t.elements.preview),i=e?e.viewportRect:t.elements.viewport.getBoundingClientRect(),o=e?e.origin:new Y(t.elements.preview);if(t._currentZoom=e?e.value:t._currentZoom,n.scale=t._currentZoom,t.options.enforceBoundary){var a=v.call(t,i),s=a.translate,l=a.origin;n.x>=s.maxX&&(o.x=l.minX,n.x=s.maxX),n.x<=s.minX&&(o.x=l.maxX,n.x=s.minX),n.y>=s.maxY&&(o.y=l.minY,n.y=s.maxY),n.y<=s.minY&&(o.y=l.maxY,n.y=s.minY)}var c={};c[R]=n.toString(),c[M]=o.toString(),r(t.elements.preview,c),V.call(t),b.call(t)}function v(e){var t=this,n=t._currentZoom,i=e.width,o=e.height,r=t.options.boundary.width/2,a=t.options.boundary.height/2,s=t.elements.preview.getBoundingClientRect(),l=s.width,c=s.height,d=i/2,u=o/2,h=-1*(d/n-r),m=h-(l*(1/n)-i*(1/n)),p=-1*(u/n-a),f=p-(c*(1/n)-o*(1/n)),v=1/n*d,g=l*(1/n)-v,y=1/n*u,C=c*(1/n)-y;return{translate:{maxX:h,minX:m,maxY:p,minY:f},origin:{maxX:g,minX:v,maxY:C,minY:y}}}function g(){var e=this,t=e._currentZoom,n=e.elements.preview.getBoundingClientRect(),i=e.elements.viewport.getBoundingClientRect(),o=$.parse(e.elements.preview.style[R]),a=new Y(e.elements.preview),s=i.top-n.top+i.height/2,l=i.left-n.left+i.width/2,c={},d={};c.y=s/t,c.x=l/t,d.y=(c.y-a.y)*(1-t),d.x=(c.x-a.x)*(1-t),o.x-=d.x,o.y-=d.y;var u={};u[M]=c.x+"px "+c.y+"px",u[R]=o.toString(),r(e.elements.preview,u)}function y(){function e(e){if(e.preventDefault(),!d){if(d=!0,i=e.pageX,a=e.pageY,e.touches){var o=e.touches[0];i=o.pageX,a=o.pageY}transform=$.parse(c.elements.preview),window.addEventListener("mousemove",t),window.addEventListener("touchmove",t),window.addEventListener("mouseup",n),window.addEventListener("touchend",n),document.body.style[H]="none",l=c.elements.viewport.getBoundingClientRect()}}function t(e){e.preventDefault();var t=e.pageX,n=e.pageY;if(e.touches){var d=e.touches[0];t=d.pageX,n=d.pageY}var u=t-i,h=n-a,p=c.elements.preview.getBoundingClientRect(),f=transform.y+h,v=transform.x+u,g={};if("touchmove"==e.type&&e.touches.length>1){var y=e.touches[0],b=e.touches[1],I=Math.sqrt((y.pageX-b.pageX)*(y.pageX-b.pageX)+(y.pageY-b.pageY)*(y.pageY-b.pageY));s||(s=I/c._currentZoom);var E=I/s;return m.call(c,E),void o(c.elements.zoomer)}c.options.enforceBoundary?(l.top>p.top+h&&l.bottom<p.bottom+h&&(transform.y=f),l.left>p.left+u&&l.right<p.right+u&&(transform.x=v)):(transform.y=f,transform.x=v),g[R]=transform.toString(),r(c.elements.preview,g),C.call(c),a=n,i=t}function n(){d=!1,window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",t),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),document.body.style[H]="",g.call(c),b.call(c),s=0}var i,a,s,l,c=this,d=!1;c.elements.overlay.addEventListener("mousedown",e),c.elements.overlay.addEventListener("touchstart",e)}function C(){var e=this,t=e.elements.boundary.getBoundingClientRect(),n=e.elements.preview.getBoundingClientRect();r(e.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-t.top+"px",left:n.left-t.left+"px"})}function b(){var e=this;I.call(e)&&e.options.update.call(e,e.get())}function I(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function E(){var e,t,n,i,a,s=this,l=0,c=1.5,d=1,u={},h=s.elements.preview,p=s.elements.zoomer,f=new $(0,0,d),v=new Y,y=I.call(s);y&&!s.data.bound&&(s.data.bound=!0,u[R]=f.toString(),u[M]=v.toString(),u.opacity=1,r(h,u),e=h.getBoundingClientRect(),t=s.elements.viewport.getBoundingClientRect(),n=s.elements.boundary.getBoundingClientRect(),s._originalImageWidth=e.width,s._originalImageHeight=e.height,s.options.enableZoom&&(s.options.enforceBoundary&&(i=t.width/e.width,a=t.height/e.height,l=Math.max(i,a)),l>=c&&(c=l+1),p.min=x(l,4),p.max=x(c,4),d=Math.max(n.width/e.width,n.height/e.height),m.call(s,d),o(p)),s._currentZoom=f.scale=d,u[R]=f.toString(),r(h,u),s.data.points.length?_.call(s,s.data.points):w.call(s),g.call(s),C.call(s))}function _(e){if(4!=e.length)throw"Croppie - Invalid number of points supplied: "+e;var t=this,n=e[2]-e[0],i=t.elements.viewport.getBoundingClientRect(),o=t.elements.boundary.getBoundingClientRect(),a={left:i.left-o.left,top:i.top-o.top},s=i.width/n,l=e[1],c=e[0],d=-1*e[1]+a.top,u=-1*e[0]+a.left,h={};h[M]=c+"px "+l+"px",h[R]=new $(u,d,s).toString(),r(t.elements.preview,h),m.call(t,s),t._currentZoom=s}function w(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=e.elements.boundary.getBoundingClientRect(),o=n.left-i.left,a=n.top-i.top,s=o-(t.width-n.width)/2,l=a-(t.height-n.height)/2,c=new $(s,l,e._currentZoom);r(e.elements.preview,R,c.toString())}function L(e){var t=this,n=t.elements.canvas,i=t.elements.img,o=n.getContext("2d"),r=h.call(t),e=t.options.enableOrientation&&e;o.clearRect(0,0,n.width,n.height),n.width=i.width,n.height=i.height,r?c(i,function(t){d(n,i,parseInt(t)),e&&d(n,i,e)}):e&&d(n,i,e)}function B(e){var t=e.points,n=document.createElement("div"),i=document.createElement("img"),o=t[2]-t[0],s=t[3]-t[1];return a(n,"croppie-result"),n.appendChild(i),r(i,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),i.src=e.url,r(n,{width:o+"px",height:s+"px"}),n}function S(e,t){var n=t.points,i=n[0],o=n[1],r=n[2]-n[0],a=n[3]-n[1],s=t.circle,l=document.createElement("canvas"),c=l.getContext("2d"),d=r,u=a;return t.outputWidth&&t.outputHeight&&(d=t.outputWidth,u=t.outputHeight),l.width=d,l.height=u,c.drawImage(e,i,o,r,a,0,0,d,u),s&&(c.fillStyle="#fff",c.globalCompositeOperation="destination-in",c.beginPath(),c.arc(d/2,u/2,d/2,0,2*Math.PI,!0),c.closePath(),c.fill()),l.toDataURL(t.format,t.quality)}function k(e,t){var n,i=this,o=[];if("string"==typeof e)n=e,e={};else if(Array.isArray(e))o=e.slice();else{if("undefined"==typeof e&&i.data.url)return E.call(i),b.call(i),null;n=e.url,o=e.points||[]}i.data.bound=!1,i.data.url=n||i.data.url,i.data.points=(o||i.data.points).map(function(e){return parseFloat(e)});var r=l(n,i.elements.img);return r.then(function(){i.options.useCanvas&&(i.elements.img.exifdata=null,L.call(i,e.orientation||1)),E.call(i),b.call(i),t&&t()}),r}function x(e,t){return parseFloat(e).toFixed(t||0)}function A(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=n.left-t.left,o=n.top-t.top,r=i+n.width,a=o+n.height,s=e._currentZoom;(s===1/0||isNaN(s))&&(s=1);var l=e.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(l,i/s),o=Math.max(l,o/s),r=Math.max(l,r/s),a=Math.max(l,a/s),{points:[x(i),x(o),x(r),x(a)],zoom:s}}function D(e){var t,i=this,o=A.call(i),r=n(G,n({},e)),a="string"==typeof e?e:r.type||"viewport",s=r.size,l=r.format,c=r.quality,d=i.elements.viewport.getBoundingClientRect(),u=d.width/d.height;return"viewport"===s?(o.outputWidth=d.width,o.outputHeight=d.height):"object"===("undefined"==typeof s?"undefined":babelHelpers["typeof"](s))&&(s.width&&s.height?(o.outputWidth=s.width,o.outputHeight=s.height):s.width?(o.outputWidth=s.width,o.outputHeight=s.width/u):s.height&&(o.outputWidth=s.height*u,o.outputHeight=s.height)),X.indexOf(l)>-1&&(o.format="image/"+l,o.quality=c),o.circle="circle"===i.options.viewport.type,o.url=i.data.url,t=new Promise(function(e,t){e("canvas"===a?S.call(i,i.elements.preview,o):B.call(i,o))})}function F(){E.call(this)}function N(e){if(!this.options.useCanvas)throw"Croppie: Cannot rotate without enableOrientation";var t=this,n=t.elements.canvas,i=(t.elements.img,document.createElement("canvas")),o=1;i.width=n.width,i.height=n.height;var r=i.getContext("2d");r.drawImage(n,0,0),90!==e&&-270!==e||(o=6),-90!==e&&270!==e||(o=8),180!==e&&-180!==e||(o=3),d(n,i,o),f.call(t)}function T(){var e=this;e.element.removeChild(e.elements.boundary),s(e.element,"croppie-container"),e.options.enableZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}function P(e,t){if(this.element=e,this.options=n(n({},P.defaults),t),u.call(this),this.options.url){var i={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,k.call(this,i)}}"function"!=typeof Promise&&!function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=babelHelpers["typeof"](this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(e,t(o,this),t(r,this))}function i(e){var t=this;return null===this._state?void this._deferreds.push(e):void d(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void(t._state?e.resolve:e.reject)(t._value);var i;try{i=n(t._value)}catch(o){return void e.reject(o)}e.resolve(i)})}function o(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void l(t(n,e),t(o,this),t(r,this))}this._state=!0,this._value=e,a.call(this)}catch(i){r.call(this,i)}}function r(e){this._state=!1,this._value=e,a.call(this)}function a(){for(var e=0,t=this._deferreds.length;t>e;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function l(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(o){if(i)return;i=!0,n(o)}}var c=setTimeout,d="function"==typeof setImmediate&&setImmediate||function(e){c(e,1)},u=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var o=this;return new n(function(n,r){i.call(o,new s(e,t,n,r))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&u(arguments[0])?arguments[0]:arguments);return new n(function(t,n){function i(r,a){try{if(a&&("object"==("undefined"==typeof a?"undefined":babelHelpers["typeof"](a))||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){i(r,e)},n)}e[r]=a,0===--o&&t(e)}catch(l){n(l)}}if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)i(r,e[r])})},n.resolve=function(e){return e&&"object"==("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var i=0,o=e.length;o>i;i++)e[i].then(t,n)})},n._setImmediateFn=function(e){d=e},"undefined"!=typeof module&&module.exports?module.exports=n:e.Promise||(e.Promise=n)}(this);var M,R,H,O=["Webkit","Moz","ms"],U=document.createElement("div").style;R=t("transform"),M=t("transformOrigin"),H=t("userSelect");var q="translate3d",j=", 0px",$=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};$.parse=function(e){return e.style?$.parse(e.style[R]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?$.fromMatrix(e):$.fromString(e)},$.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new $(parseInt(t[4],10),parseInt(t[5],10),parseFloat(t[0]))},$.fromString=function(e){var t=e.split(") "),n=t[0].substring(q.length+1).split(","),i=t.length>1?t[1].substring(6):1,o=n.length>1?n[0]:0,r=n.length>1?n[1]:0;return new $(o,r,i)},$.prototype.toString=function(){return q+"("+this.x+"px, "+this.y+"px"+j+") scale("+this.scale+")"};var Y=function(e){if(!e||!e.style[M])return this.x=0,void(this.y=0);var t=e.style[M].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};Y.prototype.toString=function(){return this.x+"px "+this.y+"px"};var V=i(C,500),G={type:"canvas",format:"png",quality:1},X=["jpeg","webp","png"];if(window.jQuery){var J=window.jQuery;J.fn.croppie=function(e){var t="undefined"==typeof e?"undefined":babelHelpers["typeof"](e);if("string"===t){var n=Array.prototype.slice.call(arguments,1),i=J(this).data("croppie");return"get"===e?i.get():"result"===e?i.result.apply(i,n):this.each(function(){var t=J(this).data("croppie");if(t){var i=t[e];if(!J.isFunction(i))throw"Croppie "+e+" method not found";i.apply(t,n),"destroy"===e&&J(this).removeData("croppie")}})}return this.each(function(){var t=new P(this,e);J(this).data("croppie",t)})}}P.defaults={viewport:{width:100,height:100,type:"square"},boundary:{width:300,height:300},orientationControls:{enabled:!0,leftClass:"",rightClass:""},customClass:"",showZoomer:!0,enableZoom:!0,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,update:function(){}},n(P.prototype,{bind:function(e,t){return k.call(this,e,t)},get:function(){return A.call(this)},result:function(e){return D.call(this,e)},refresh:function(){return F.call(this)},setZoom:function(e){m.call(this,e),o(this.elements.zoomer)},rotate:function(e){N.call(this,e)},destroy:function(){return T.call(this)}}),e.Croppie=window.Croppie=P,"object"===("undefined"==typeof module?"undefined":babelHelpers["typeof"](module))&&module.exports&&(module.exports=P)});var Route$1={_routes:[],_routeSegments:{},is:function(e){var t=arguments.length<=1||void 0===arguments[1]?window.location.pathname:arguments[1],n=t.split("/"),i=e.split("/"),o=n.length,r=i.length;if(o!==r)return!1;for(var a=1;o>a;a++)if(-1===i[a].indexOf("{")&&i[a]!==n[a])return!1;return!0},params:function e(t){for(var n=window.location.pathname.split("/"),i=t.split("/"),o=i.length,e={},r=1;o>r;r++)if(-1!==i[r].indexOf("{")){var a=i[r].substr(1,i[r].length-2);e[a]=n[r]}return e},get:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=this.defined(e);return i!==!1?!1:void(this._routes[e]={handler:t,method:n})},defined:function(e){if(void 0!==this._routes[e])return e;for(var t in this._routes)if(this.is(t,e))return t;return!1},call:function(e){var t=this.defined(e);if(t===!1)return!1;if(null===this._routes[t].method){var n=this._routes[t].handler.bind(this._routes[t].handler);n(this.params(t))}else{var i=this._routes[t].handler,o=this._routes[t].method;i[o](this.params(t))}},to:function(e){if(!this.defined(e))return!1;history.pushState(null,null,e);var t=new CustomEvent("onRouteChange");t.route=e,document.dispatchEvent(t,e)}};document.addEventListener("DOMContentLoaded",function(){Route$1.defined(window.location.pathname)&&Route$1.call(window.location.pathname)},!1),document.addEventListener("onRouteChange",function(e){Route$1.defined(e.route)&&Route$1.call(e.route)},!1);var Route=Object.create(Route$1);Route.get=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return""!==Server.app.localePrefix&&(e="/"===e?Server.app.localePrefix:Server.app.localePrefix+e),Route$1.get(e,t,n)};var Ajax$1={create:function(e,t,n,i){var o=arguments.length<=4||void 0===arguments[4]?null:arguments[4],r=arguments.length<=5||void 0===arguments[5]?{}:arguments[5],a=arguments.length<=6||void 0===arguments[6]?!0:arguments[6],s=Object.create(this);return s.method=e,s.url=t,s.data=n,s.request=new XMLHttpRequest,s.onSuccess=i,s.onError=o,s.headers=r,s.request.onreadystatechange=function(){s.request.readyState===XMLHttpRequest.DONE&&(200===s.request.status?s.onSuccess(s.request.responseText):null!==s.onError&&s.onError(s.request.responseText,s.request.status))},a&&s.send(),s},send:function(){this.request.open(this.method,this.url);for(var e in this.headers)this.request.setRequestHeader(e,this.headers[e]);var t="";for(var n in this.data)t=t+n+"="+encodeURIComponent(this.data[n])+"&";this.request.send(t)},sendForm:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=arguments.length<=3||void 0===arguments[3]?{"Content-Type":"application/x-www-form-urlencoded"}:arguments[3],o={};e.querySelectorAll("[name]").forEach(function(e){o[e.getAttribute("name")]=e.value}),this.create("POST",e.getAttribute("action"),o,t,n,i,!0)},sendFormWithFiles:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=arguments.length<=3||void 0===arguments[3]?{"Content-Type":"multipart/form-data"}:arguments[3];this.sendForm(e,t,n,i)},get:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=arguments.length<=3||void 0===arguments[3]?{"X-Requested-With":"XMLHttpRequest"}:arguments[3];this.create("GET",e,{},t,n,i,!0)}},Checkbox={create:function(e,t,n){document.getElementsByClassName(e).forEach(function(e){var i=e.getElementsByClassName(t)[0];if(void 0!==i){var o=e.getElementsByTagName("input")[0];o.checked&&!i.classList.contains(n)&&i.classList.add(n),o.addEventListener("change",function(){o.checked?i.classList.add(n):i.classList.remove(n)})}})}},FileUpload={download:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=new XMLHttpRequest;i.onload=function(){if(4===this.readyState)if(200===this.status){var e=this.response;t(e)}else null!==n&&n(this.response,this.status)},i.open("GET",e,!0),i.responseType="blob",i.send()},addToForm:function(e,t,n){if("object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e)))var i=e;else var i=document.getElementById(e);var o=new FormData(i);return o.append(t,n),o},previewImageFromInput:function(e,t){if("object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e)))var n=e;else var n=document.getElementById(e);if("object"===("undefined"==typeof t?"undefined":babelHelpers["typeof"](t)))var i=t;else var i=document.getElementById(t);n.src=URL.createObjectURL(i.files[0])},previewImageFromBlob:function(e,t){if("object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e)))var n=e;else var n=document.getElementById(e);n.src=URL.createObjectURL(t)},attachImagePreviewEvent:function(e,t){var n=this;if("object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e)))var i=e;else var i=document.getElementById(e);if("object"===("undefined"==typeof t?"undefined":babelHelpers["typeof"](t)))var o=t;else var o=document.getElementById(t);o.addEventListener("change",function(){n.previewImageFromInput(i,o)})}},Spinner={_class:"app-spinner",_get:function(e){return"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))?e:document.getElementById(e)},_getSpinner:function(e){var t=e.getElementsByClassName(this._class)[0];
return void 0===t?!1:t},_createSpinner:function(){var e=document.createElement("div");return e.classList.add(this._class),e},add:function(e){var t=this._get(e),n=this._getSpinner(t);n===!1&&this._add(t,n)},_add:function(e,t){t=this._createSpinner(),e.insertBefore(t,e.firstChild),e.setAttribute("disabled","disabled")},remove:function(e){var t=this._get(e),n=this._getSpinner(t);n!==!1&&this._remove(t,n)},_remove:function(e,t){e.removeChild(t),e.blur(),e.removeAttribute("disabled")},toggle:function(e){var t=this._get(e),n=this._getSpinner(t);n===!1?this._add(t,n):this._remove(t,n)}},GalleryUploads={files:[],previewId:"gallery_preview",inputId:"gallery",imgClass:"app-gallery-item",resizeMaxWidth:1200,resizeMaxHeight:1200,collectFilesListener:function(){var e=this,t=this,n=document.getElementById(this.inputId);n.addEventListener("change",function(i){var o=i.target||i.srcElement;if(n.files.length>1)for(var r=0;r<n.files.length;r++)t.files.push(n.files[r]);else 1==n.files.length&&t.files.push(n.files[0]);var a=document.getElementById(e.previewId);if(a)for(;a.firstChild;)a.removeChild(a.firstChild);for(var s=function(n){t.files[n];c=URL.createObjectURL(t.files[n]),d=document.createElement("div"),d.setAttribute("style","background-image: url("+c+")"),d.setAttribute("role","button"),d.setAttribute("class",e.imgClass),a.appendChild(d),d.addEventListener("click",function(e){var i=e.target||e.srcElement;t.files.splice(n,1),i.remove()})},l=0;l<t.files.length;l++){var c,d;s(l)}o.value=null})}},Lib={options:{},more:function(e){var t=this,n=Spinner,i=document.getElementById(e);i.setAttribute("disabled","disabled");var o=document.querySelectorAll("[name^=categories][checked]"),r="";o.forEach(function(e){r+="&"+e.name+"=1"}),n.add(i),setTimeout(function(){n.remove(i)},2e3);var a=t.options.contentUrl+t.options.decorator.contentPage+r;Ajax$1.get(a,function(e){var o=JSON.parse(e);t.options.decorator.moreButtonDecorator(o,i,n)})},sendCommentForm:function(e){var t=this;if(!(e instanceof Node&&"form"==e.tagName.toLowerCase()))return!1;var n=e.getElementsByTagName("input"),i=""!==n[0].value?n[0].value:"null",o="/"+this.options.prefix+this.options.replyUrl+i,r=new FormData(e),a=new XMLHttpRequest;e.getElementsByTagName("textarea")[0].value=null,a.open("POST",o,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.onload=function(){if(a.readyState===XMLHttpRequest.DONE&&200==a.status){var e=JSON.parse(a.responseText);e.result&&t.options.decorator.newCommentDecorator(i,e)}},a.send(r)},deleteComment:function(e){var t="/"+this.options.prefix+this.options.deleteReplyUrl+e;Ajax$1.get(t,function(e){var t=JSON.parse(e);t.result?location.reload():t.message})},sendInvites:function(e){var t=this,n=new FormData(e),i=new XMLHttpRequest,o=this.option.inviteUrl;i.open("POST",o,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onload=function(){if(i.readyState===XMLHttpRequest.DONE&&200==i.status){var e=JSON.parse(i.responseText);t.options.decorator.inviteDecorator(e)}},i.send(n)},createLike:function(e,t){if(t=t||{},e.hasAttribute("data-liked"))return!1;var n=e.getAttribute("data-like");t.id=n;var i=t.url||"/"+this.options.prefix+this.options.likeUrl;i+=n;var o=this;Ajax$1.get(i,function(e){var n=JSON.parse(e);o.options.decorator.likeDecorator(n,t)})},createNewModel:function(e){var t=this,n=this;this.submitPermission=!0,this.options.withGallery?!function(){var i=document.forms[t.options.appFormId],o=new FormData(i);if("undefined"!=typeof GalleryUploads)for(var r=GalleryUploads.files,a=void 0,s=0;s<r.length;s++)a="gallery["+s+"]",o.append(a,r[s]);var l=new XMLHttpRequest,c=location.href;l.open("POST",c,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.onload=function(){if(l.readyState===XMLHttpRequest.DONE&&200==l.status){var t=JSON.parse(l.responseText);1==t.result?location.pathname=n.options.reloadUrl:e.removeAttribute("disabled")}},l.send(o)}():document.forms[this.options.appFormId].submit()},cancelCreation:function(e){e.href&&(window.location.href=e.href)},refresh:function(e){var t=this,n=this.getNode(e.selector),i="/"+t.options.prefix+e.userDataUrl,o=n.value;return o=o.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\//g,""),""==o?!1:(i+=o,void Ajax$1.get(i+o,function(t){var i=JSON.parse(t);e.decorator(i,n)}))},recommend:function(){var e=this,t="/"+this.options.prefix+this.options.recommendUrl+this.options.current_review;Ajax$1.get(t,function(t){var n=JSON.parse(t);n.result&&e.options.decorator.recommendDecorator()})},blockUser:function(e){var t=e.getAttribute("data-blocked"),n=e.getAttribute("data-owner"),i="/"+this.options.prefix+this.options.blockUserUrl+n+"/"+t;Ajax$1.get(i,function(e){var t=JSON.parse(e);t.result?location.reload():t.message})},insertNicTextarea:function(){var e=document.getElementsByClassName("nicEdit-main");e.forEach(function(e){var t=e.parentNode,n=t.nextSibling;n.value=e.innerHTML})},insertCkeTextarea:function(){for(var e in CKEDITOR.instances)CKEDITOR.instances[e].updateElement()},setRequired:function(e){var t=document.getElementById(e);t&&t.setAttribute("required","required")},getNode:function(e){return"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))?e:document.getElementById(e)}};!function(){function e(e,t,n){for(var i in t){var o=t[i],r=e.input.getAttribute("data-"+i.toLowerCase());"number"==typeof o?e[i]=parseInt(r):o===!1?e[i]=null!==r:o instanceof Function?e[i]=null:e[i]=r,e[i]||0===e[i]||(e[i]=i in n?n[i]:o)}}function t(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function n(e,t){return r.call((t||document).querySelectorAll(e))}function i(){n("input.awesomplete").forEach(function(e){new o(e)})}var o=function a(n,i){var o=this;this.input=t(n),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-autocomplete","list"),i=i||{},e(this,{minChars:2,maxItems:10,autoFirst:!1,filter:a.FILTER_CONTAINS,sort:a.SORT_BYLENGTH,item:a.ITEM,replace:a.REPLACE},i),this.index=-1,this.container=t.create("div",{className:"awesomplete",around:n}),this.ul=t.create("ul",{hidden:"hidden",inside:this.container}),this.status=t.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container}),t.bind(this.input,{input:this.evaluate.bind(this),blur:this.close.bind(this),keydown:function(e){var t=e.keyCode;o.opened&&(13===t&&o.selected?(e.preventDefault(),o.select()):27===t?o.close():38!==t&&40!==t||(e.preventDefault(),o[38===t?"previous":"next"]()))}}),t.bind(this.input.form,{submit:this.close.bind(this)}),t.bind(this.ul,{mousedown:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),o.select(t,e.target))}}}),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||i.list||[],a.all.push(this)};o.prototype={set list(e){Array.isArray(e)?this._list=e:"string"==typeof e&&e.indexOf(",")>-1?this._list=e.split(/\s*,\s*/):(e=t(e),e&&e.children&&(this._list=r.apply(e.children).map(function(e){return e.textContent.trim()}))),document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return!this.ul.hasAttribute("hidden")},close:function(){this.ul.setAttribute("hidden",""),this.index=-1,t.fire(this.input,"awesomplete-close")},open:function(){this.ul.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this["goto"](0),t.fire(this.input,"awesomplete-open")},next:function(){var e=this.ul.children.length;this["goto"](this.index<e-1?this.index+1:-1)},previous:function(){var e=this.ul.children.length;this["goto"](this.selected?this.index-1:e-1)},"goto":function(e){var n=this.ul.children;this.selected&&n[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&n.length>0&&(n[e].setAttribute("aria-selected","true"),this.status.textContent=n[e].textContent),t.fire(this.input,"awesomplete-highlight")},select:function(e,n){if(e=e||this.ul.children[this.index]){var i=t.fire(this.input,"awesomplete-select",{text:e.textContent,data:this.suggestions[t.siblingIndex(e)],origin:n||e});i&&(this.replace(e.textContent),this.close(),t.fire(this.input,"awesomplete-selectcomplete"))}},evaluate:function(){var e=this,t=this.input.value;t.length>=this.minChars&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.filter(function(n){return e.filter(n,t)}).sort(this.sort).slice(0,this.maxItems),this.suggestions.forEach(function(n){e.ul.appendChild(e.item(n,t))}),0===this.ul.children.length?this.close():this.open()):this.close()}},o.all=[],o.FILTER_CONTAINS=function(e,n){return RegExp(t.regExpEscape(n.trim()),"i").test(e)},o.FILTER_STARTSWITH=function(e,n){return RegExp("^"+t.regExpEscape(n.trim()),"i").test(e)},o.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:t>e?-1:1},o.ITEM=function(e,n){var i=""===n?e:e.replace(RegExp(t.regExpEscape(n.trim()),"gi"),"<mark>$&</mark>");return t.create("li",{innerHTML:i,"aria-selected":"false"})},o.REPLACE=function(e){this.input.value=e};var r=Array.prototype.slice;return t.create=function(e,n){var i=document.createElement(e);for(var o in n){var r=n[o];if("inside"===o)t(r).appendChild(i);else if("around"===o){var a=t(r);a.parentNode.insertBefore(i,a),i.appendChild(a)}else o in i?i[o]=r:i.setAttribute(o,r)}return i},t.bind=function(e,t){if(e)for(var n in t){var i=t[n];n.split(/\s+/).forEach(function(t){e.addEventListener(t,i)})}},t.fire=function(e,t,n){var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!0);for(var o in n)i[o]=n[o];return e.dispatchEvent(i)},t.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},t.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?i():document.addEventListener("DOMContentLoaded",i)),o.$=t,o.$$=n,"undefined"!=typeof self&&(self.Awesomplete=o),"object"===("undefined"==typeof module?"undefined":babelHelpers["typeof"](module))&&module.exports&&(module.exports=o),o}();var Awesom={url:"/api/v1/adventures/users",autocomplete:null,init:function(e){return this.autocomplete=new Awesomplete(document.querySelector("#"+e),{list:[]}),this.autocomplete},fill:function(){var e=this;this.autocomplete&&Ajax.get(e.url,function(t){e.autocomplete.list=JSON.parse(t).map(function(e){return e.name})})}},AutocompleteMarkup={createEmptyDropdown:function(){var e=document.createElement("div");return e},createDropdownItem:function(e,t){var n=document.createElement("button");return n.setAttribute("type","button"),n.setAttribute("value",e),n.textContent=t,n},createDropdownItemsFromData:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=document.createDocumentFragment();for(var i in e){var o=this.createDropdownItem(i,e[i]);null!==t&&t(o,i,e[i]),n.appendChild(o)}return n},removeDropdown:function(e){null!==e.parentNode&&e.parentNode.removeChild(e)},insertDropdown:function(e,t){var n=e.getElementsByTagName("input")[0];n.parentNode.insertBefore(t,n.nextSibling)}},AutocompleteDecorator={theme:{bs4:{classPrefix:"",dropdownClass:["dropdown-menu","w-100"],dropdownItemClass:"dropdown-item",showClass:"open"}},buildClass:function(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],o=this.theme[n][t+"Class"];if("string"==typeof o)i?e.classList.remove(o):e.classList.add(o);else for(var r=0;r<o.length;r++)i?e.classList.remove(o[r]):e.classList.add(o[r])},decorateDropdown:function(e){var t=arguments.length<=1||void 0===arguments[1]?"bs4":arguments[1];this.buildClass(e,"dropdown",t)},decorateDropdownItem:function(e){var t=arguments.length<=1||void 0===arguments[1]?"bs4":arguments[1];this.buildClass(e,"dropdownItem",t)},showDropdown:function(e){var t=arguments.length<=1||void 0===arguments[1]?"bs4":arguments[1];this.buildClass(e,"show",t)},hideDropdown:function(e){var t=arguments.length<=1||void 0===arguments[1]?"bs4":arguments[1];this.buildClass(e,"show",t,!0)}},AutocompleteController={inputDelay:function(e,t){var n=0;!function(){clearTimeout(n),n=setTimeout(e,t)}()},attachInputTypeEvent:function(e){var t=arguments.length<=1||void 0===arguments[1]?JSON.parse:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=Autocomplete.get(e),o=0;i._picked=!1,i.input.addEventListener("input",function(){var r=this;clearTimeout(o),r.value.length>=i.options.minCharLimit&&(o=setTimeout(function(){var o=i.ajaxUrl.replace("{search}",encodeURI(r.value));Ajax$1.get(o,function(n){var i=t(n);0!==i.length?(Autocomplete.setItems(e,i),Autocomplete.show(e)):Autocomplete.hide(e)},function(t,n){null!==i.options.ajaxErrorHandler&&i.options.ajaxErrorHandler(t,n),Autocomplete.hide(e)},n)},i.options.inputDelay))})},attachInputFocusEvent:function(e){var t=Autocomplete.get(e);t.input.addEventListener("focus",function(e){t._picked=!1,t._valueOnFocus=this.value})},attachInputOutEvent:function(e){var t=Autocomplete.get(e);t.input.addEventListener("blur",function(n){var i=this;setTimeout(function(){t._picked||(t.options.allowCustomInput?null!==t.hiddenInput&&(t.hiddenInput.value=t.options.defaultCustomHiddenInputValue):t._valueOnFocus!==i.value&&Autocomplete.restoreDefaultValue(e),Autocomplete.hide(e)),t._picked=!1},150)})},attachItemSelectEvent:function(e){for(var t=Autocomplete.get(e),n=this,i=0;i<t.dropdownItems.length;i++)t.dropdownItems[i].addEventListener("mousedown",function(t){0===t.button&&(t.preventDefault(),n.selectItem(e,this))})},selectItem:function(e,t){var n=Autocomplete.get(e),i=t.getAttribute("value");null===i&&(i=t.innerHTML),n._picked=!0,Autocomplete.hide(e),n.input.value=t.innerHTML,null!==n.hiddenInput&&(n.hiddenInput.value=i);for(var o=0;o<n.itemSelectHandlers.length;o++)n.itemSelectHandlers[o](i,t.innerHTML)},attachInputKeydownEvent:function(e){var t=Autocomplete.get(e),n=this;t.input.addEventListener("keydown",function(i){var o=i.keyCode;Autocomplete.isOpened(e)&&(9===o?null===t._currentItemIndex?n.selectItem(e,t.dropdownItems[0]):n.selectItem(e,t.dropdownItems[t._currentItemIndex]):13===o?null!==t._currentItemIndex&&n.selectItem(e,t.dropdownItems[t._currentItemIndex]):27===o?(Autocomplete.restoreDefaultValue(e),Autocomplete.hide(e),i.preventDefault()):38===o?null!==t._currentItemIndex&&t._currentItemIndex>0&&(t.dropdownItems[t._currentItemIndex].classList.toggle("active"),t._currentItemIndex-=1,t.dropdownItems[t._currentItemIndex].classList.toggle("active"),t.dropdownItems[t._currentItemIndex].scrollIntoView(!1)):40===o&&(null===t._currentItemIndex?(t._currentItemIndex=0,t.dropdownItems[0].classList.toggle("active")):t._currentItemIndex+1<t.dropdownItems.length&&(t.dropdownItems[t._currentItemIndex].classList.toggle("active"),t._currentItemIndex+=1,t.dropdownItems[t._currentItemIndex].classList.toggle("active"),t.dropdownItems[t._currentItemIndex].scrollIntoView(!1))))})}},Autocomplete={_autocompleteContainers:[],_options:{theme:"bs4",minCharLimit:2,inputDelay:200,allowCustomInput:!1,defaultCustomHiddenInputValue:"",ajaxHeaders:{},ajaxErrorHandler:null},create:function(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?JSON.parse:arguments[3],o=arguments.length<=4||void 0===arguments[4]?{}:arguments[4];for(var r in this._options)void 0===o[r]&&(o[r]=this._options[r]);if(-1===n.indexOf("{search}"))return!1;var a=e+"_autocomplete",s=document.getElementById(a);if(null===s)return!1;var l=document.getElementById(e),c=l.getAttribute("value");null===c&&(c="");var d=document.getElementById(t),u=null;null!==d&&(u=d.value);var h=null;this._autocompleteContainers[a]={ajaxUrl:n,container:s,input:l,hiddenInput:d,dropdown:h,dropdownItems:[],itemSelectHandlers:[],defaultValue:c,defaultHiddenValue:u,dataHandler:i,_picked:!1,_onFocusValue:c,_isOpened:!1,_currentItemIndex:null,options:o},AutocompleteController.attachInputTypeEvent(a,i,o.ajaxHeaders),AutocompleteController.attachInputFocusEvent(a),AutocompleteController.attachInputOutEvent(a),AutocompleteController.attachInputKeydownEvent(a)},get:function(e){return this._autocompleteContainers[e]},setItems:function(e,t){var n=this._autocompleteContainers[e];null!==n.dropdown&&(AutocompleteMarkup.removeDropdown(n.dropdown),n.dropdownItems=[],n._currentItemIndex=null);var i=AutocompleteMarkup.createEmptyDropdown();AutocompleteDecorator.decorateDropdown(i,n.options.theme);var o=AutocompleteMarkup.createDropdownItemsFromData(t,function(e,t){AutocompleteDecorator.decorateDropdownItem(e,n.options.theme),n.dropdownItems.push(e)});i.appendChild(o),n.dropdown=i,AutocompleteMarkup.insertDropdown(n.container,i),AutocompleteController.attachItemSelectEvent(e)},show:function(e){this._autocompleteContainers[e]._isOpened=!0,AutocompleteDecorator.showDropdown(this._autocompleteContainers[e].container,this._autocompleteContainers[e].options.theme)},hide:function(e){this._autocompleteContainers[e]._isOpened=!1,AutocompleteDecorator.hideDropdown(this._autocompleteContainers[e].container,this._autocompleteContainers[e].options.theme)},isOpened:function(e){return this._autocompleteContainers[e]._isOpened},onItemSelect:function(e,t){this._autocompleteContainers[e].itemSelectHandlers.push(t)},restoreDefaultValue:function(e){var t=this.get(e);t.input.value=this.get(e).defaultValue,null!==t.defaultHiddenValue&&(t.hiddenInput.value=t.defaultHiddenValue)}},CalendarDate={getDaysInMonth:function(e,t){return new Date(e,t+1,0).getDate()},getWeeksInMonth:function(e,t){return 0===this.getDayOfWeekOfFirstMonthDay(e,t)&&28===this.getDaysInMonth(e,t)?4:5},getDayOfWeekOfFirstMonthDay:function(e,t){var n=new Date(e,t).getDay();return 0===n&&(n=7),n-1},getMonthMatrix:function(e,t){for(var n=this.getDayOfWeekOfFirstMonthDay(e,t),i=this.getDaysInMonth(e,t),o=this.getWeeksInMonth(e,t),r=[],a=1,s=0;o>s;s++){r[s]=[];for(var l=0;7>l;l++){document.createElement("td");0==s?l>=n?(r[s][l]=a,a++):r[s][l]=null:s==o-1?i>=a?(r[s][l]=a,a++):r[s][l]=null:(r[s][l]=a,a++)}}return r},getCurrentDate:function(){var e=new Date,t=e.getUTCFullYear(),n=e.getUTCMonth(),i=e.getUTCDate();return{year:t,monthIndex:n,day:i}}},CalendarMarkup={lang:{daysOfWeeks:["Mon","Thu","Wed","Thr","Fri","Sat","Sun"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},createTableHead:function(){for(var e=document.createElement("div"),t=document.createElement("div"),n=[],i=0;7>i;i++){var o=document.createElement("div");o.innerHTML=this.lang.daysOfWeeks[i],n.push(o),t.appendChild(o)}return e.appendChild(t),{thead:e,row:t,thCollection:n}},createTableBody:function(e,t){for(var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=CalendarDate.getMonthMatrix(e,t),o=document.createElement("div"),r=[],a=null,s=null,l=CalendarDate.getCurrentDate(),c=[],d=[],u=0;u<i.length;u++){var h=document.createElement("div");d.push(h),o.appendChild(h);for(var m=0;m<i[u].length;m++){var p=document.createElement("div");null===i[u][m]?r.push(p):(p.innerHTML=i[u][m],c.push(p),null!==n&&i[u][m]==n&&(a=p),l.year===e&&l.monthIndex===t&&l.day===i[u][m]&&(s=p)),h.appendChild(p)}}return{tbody:o,rowCollection:d,tdCollection:c,inactiveTdCollection:r,currentTd:a,currentDateTd:s}},createEmptyTable:function(){var e=document.createElement("div");return e},createPrevButton:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=document.createElement("div");return t.innerHTML=e,t},createNextButton:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=document.createElement("div");return t.innerHTML=e,t},createMonthSelect:function(){for(var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=document.createElement("select"),n=0;n<this.lang.months.length;n++){var i=document.createElement("option");i.setAttribute("value",n),i.innerHTML=this.lang.months[n],n==e&&i.setAttribute("selected",1),t.appendChild(i)}return t},createYearSelect:function(){for(var e=arguments.length<=0||void 0===arguments[0]?2e3:arguments[0],t=arguments.length<=1||void 0===arguments[1]?1950:arguments[1],n=arguments.length<=2||void 0===arguments[2]?2050:arguments[2],i=document.createElement("select"),o=t;n>=o;o++){var r=document.createElement("option");r.setAttribute("value",o),r.innerHTML=o,o==e&&r.setAttribute("selected",!0),i.appendChild(r)}return i},createEmptyHeader:function(){var e=document.createElement("header");return e},createEmptyCalendar:function(){var e=document.createElement("calendar");return e}},CalendarDecorator={theme:{def:{classPrefix:"bny-",calendarClass:"cal",headerClass:"cal-header",monthClass:"cal-month",yearClass:"cal-year",prevButtonClass:"cal-prev",nextButtonClass:"cal-next",tableClass:"cal-table",tableHeadClass:"cal-head",tableHeadDayOfWeekClass:"cal-day-of-week",tableBodyClass:"cal-body",tableRowClass:"cal-row",weekClass:"cal-week",dayClass:"cal-day",dayInactiveClass:"cal-day-inactive",dayCurrentClass:"cal-day-current",currentDateClass:"cal-day-today",popupClass:"cal-popup",popupBodyFadeClass:"cal-popup-body-fade"}},buildClass:function(e){var t=arguments.length<=1||void 0===arguments[1]?"def":arguments[1];return this.theme[t].classPrefix+this.theme[t][e+"Class"]},decorateTableHead:function(e,t,n){e.classList.add(this.buildClass("tableHead")),t.classList.add(this.buildClass("tableRow"));for(var i=0;i<n.length;i++)n[i].classList.add(this.buildClass("tableHeadDayOfWeek"))},decorateTableBody:function(e,t,n,i,o,r){e.classList.add(this.buildClass("tableBody"));for(var a=0;a<t.length;a++)t[a].classList.add(this.buildClass("tableRow")),t[a].classList.add(this.buildClass("week"));for(a=0;a<n.length;a++)n[a].classList.add(this.buildClass("day"));for(a=0;a<i.length;a++)i[a].classList.add(this.buildClass("dayInactive"));null!==o&&o.classList.add(this.buildClass("dayCurrent")),null!==r&&r.classList.add(this.buildClass("currentDate"))},setCurrentDay:function(e,t){for(var n=0;n<e.length;n++)e[n].innerHTML==t?e[n].classList.add(this.buildClass("dayCurrent")):e[n].classList.contains(this.buildClass("dayCurrent"))&&e[n].classList.remove(this.buildClass("dayCurrent"))},decorateTable:function(e){e.classList.add(this.buildClass("table"))},decoratePrevButton:function(e){e.classList.add(this.buildClass("prevButton"))},decorateNextButton:function(e){e.classList.add(this.buildClass("nextButton"))},decorateMonthSelect:function(e){e.classList.add(this.buildClass("month"))},decorateYearSelect:function(e){e.classList.add(this.buildClass("year"))},decorateHeader:function(e){e.classList.add(this.buildClass("header"))},decorateCalendar:function(e){e.classList.add(this.buildClass("calendar"))},decorateCalendarPopup:function(e){e.classList.add(this.buildClass("popup")),document.body.classList.add(this.buildClass("popupBodyFade"))},undecorateCalendarPopup:function(e){e.classList.remove(this.buildClass("popup")),document.body.classList.remove(this.buildClass("popupBodyFade"))}},CalendarController={attachDayClickEvent:function(e){for(var t=Calendar._calendars[e].tableBody.tdCollection,n=0;n<t.length;n++)t[n].addEventListener("click",function(){Calendar.pickDay(e,Calendar._calendars[e].displayedYear,Calendar._calendars[e].displayedMonthIndex,this.innerHTML)})},attachMonthSelectEvent:function(e){Calendar._calendars[e].headerMonthSelect.addEventListener("change",function(){Calendar.changeMonth(e,Calendar._calendars[e].displayedYear,this.value)})},attachYearSelectEvent:function(e){Calendar._calendars[e].headerYearSelect.addEventListener("change",function(){Calendar.changeMonth(e,this.value,Calendar._calendars[e].displayedMonthIndex)})},attachPrevClickEvent:function(e){Calendar._calendars[e].headerPrevButton.addEventListener("click",function(){0===Calendar._calendars[e].displayedMonthIndex?Calendar.changeMonth(e,Calendar._calendars[e].displayedYear-1,11):Calendar.changeMonth(e,Calendar._calendars[e].displayedYear,Calendar._calendars[e].displayedMonthIndex-1)})},attachNextClickEvent:function(e){Calendar._calendars[e].headerNextButton.addEventListener("click",function(){11===Calendar._calendars[e].displayedMonthIndex?Calendar.changeMonth(e,Calendar._calendars[e].displayedYear+1,0):Calendar.changeMonth(e,Calendar._calendars[e].displayedYear,Calendar._calendars[e].displayedMonthIndex+1)})},attachCloseOnOutsideClickEvent:function(e){document.addEventListener("click",function(){Calendar.isHidden(e)||Calendar.hide(e)}),Calendar.getCalendar(e).addEventListener("click",function(e){e.stopPropagation()})}},Calendar={_calendars:{},create:function(){var e=arguments.length<=0||void 0===arguments[0]?"datepicker":arguments[0],t=arguments.length<=1||void 0===arguments[1]?1950:arguments[1],n=arguments.length<=2||void 0===arguments[2]?2050:arguments[2],i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],o=arguments.length<=4||void 0===arguments[4]?null:arguments[4],r=arguments.length<=5||void 0===arguments[5]?null:arguments[5],a=CalendarDate.getCurrentDate();null===i&&(i=a.year),null===o&&(o=a.monthIndex),null===r&&(r=a.day);var s=CalendarMarkup.createEmptyCalendar();CalendarDecorator.decorateCalendar(s);var l=CalendarMarkup.createEmptyHeader();CalendarDecorator.decorateHeader(l);var c=CalendarMarkup.createPrevButton();CalendarDecorator.decoratePrevButton(c);var d=CalendarMarkup.createNextButton();CalendarDecorator.decorateNextButton(d);var u=CalendarMarkup.createMonthSelect(o);CalendarDecorator.decorateMonthSelect(u);var h=CalendarMarkup.createYearSelect(i,t,n);CalendarDecorator.decorateYearSelect(h),l.appendChild(c),l.appendChild(u),l.appendChild(h),l.appendChild(d);var m=CalendarMarkup.createEmptyTable();CalendarDecorator.decorateTable(m);var p=CalendarMarkup.createTableHead();CalendarDecorator.decorateTableHead(p.thead,p.row,p.thCollection);var f=CalendarMarkup.createTableBody(i,o,r);return CalendarDecorator.decorateTableBody(f.tbody,f.rowCollection,f.tdCollection,f.inactiveTdCollection,f.currentTd,f.currentDateTd),m.appendChild(p.thead),m.appendChild(f.tbody),s.appendChild(l),s.appendChild(m),this._calendars[e]={selectedYear:i,selectedMonthIndex:o,selectedDay:r,displayedYear:i,displayedMonthIndex:o,minYear:t,maxYear:n,calendar:s,header:l,headerPrevButton:c,headerMonthSelect:u,headerYearSelect:h,headerNextButton:d,table:m,tableHead:p,tableBody:f,onPickHandlers:[]},CalendarController.attachPrevClickEvent(e),CalendarController.attachNextClickEvent(e),CalendarController.attachMonthSelectEvent(e),CalendarController.attachYearSelectEvent(e),CalendarController.attachDayClickEvent(e),CalendarController.attachCloseOnOutsideClickEvent(e),s},changeMonth:function(e,t,n){var i=this._calendars[e];if(t<i.minYear||t>i.maxYear)return!1;var o=null;t==i.selectedYear&&n==i.selectedMonthIndex&&(o=i.selectedDay),i.displayedYear=t,i.displayedMonthIndex=n;var r=CalendarMarkup.createTableBody(t,n,o);CalendarDecorator.decorateTableBody(r.tbody,r.rowCollection,r.tdCollection,r.inactiveTdCollection,r.currentTd,r.currentDateTd),i.tableBody.tbody.parentNode.removeChild(i.tableBody.tbody),i.tableBody=r,i.table.appendChild(r.tbody),i.headerYearSelect.querySelector("option[selected]").removeAttribute("selected"),i.headerYearSelect.querySelector('option[value="'+t+'"]').setAttribute("selected","selected"),i.headerYearSelect.value=t,i.headerMonthSelect.querySelector("option[selected]").removeAttribute("selected"),i.headerMonthSelect.options[n].setAttribute("selected","selected"),i.headerMonthSelect.value=n,CalendarController.attachDayClickEvent(e)},pickDay:function(e,t,n,i){this._calendars[e].selectedYear=t,this._calendars[e].selectedMonthIndex=n,this._calendars[e].selectedDay=i,CalendarDecorator.setCurrentDay(this._calendars[e].tableBody.tdCollection,i);for(var o=0;o<this._calendars[e].onPickHandlers.length;o++){var r=parseInt(n)+1,t=parseInt(t),i=parseInt(i);this._calendars[e].onPickHandlers[o](t,r,i)}},onPick:function(e,t){this._calendars[e].onPickHandlers.push(t)},getCalendar:function(e){return this._calendars[e].calendar},show:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];t&&CalendarDecorator.decorateCalendarPopup(this._calendars[e].calendar),this._calendars[e].calendar.classList.remove("hidden")},hide:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];t&&CalendarDecorator.undecorateCalendarPopup(this._calendars[e].calendar),this._calendars[e].calendar.classList.add("hidden")},isHidden:function(e){return this._calendars[e].calendar.classList.contains("hidden")}},DatePicker={_pickers:{},_options:{minYear:1950,maxYear:2050,popup:!1,onlyAsNativeFallback:!0},create:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];for(var n in this._options)void 0===t[n]&&(t[n]=this._options[n]);if(t.onlyAsNativeFallback&&this.isNativeDatePickerSupported())return 2;var i=this,o=document.getElementById(e),r=o.name;o.id="_"+e,o.name="_"+r;var a=document.createElement("input");a.id=e,a.name=r,a.type="hidden",o.parentNode.insertBefore(a,o.nextSibling);var s=e+"_calendar";if(""!==o.value){a.value=i.getSqlDateFromEuropeanDate(o.value);var l=this.getDatePartsFromISODate(a.value);Calendar.create(s,t.minYear,t.maxYear,l.year,l.monthIndex,l.day)}else Calendar.create(s,t.minYear,t.maxYear);return Calendar.hide(s,t.popup),Calendar.onPick(s,function(e,n,r){a.value=i.getSqlDateFromDateParts(e,n-1,r),o.value=i.getEuropeanDateFromDateParts(e,n-1,r),Calendar.hide(s,t.popup)}),o.addEventListener("focus",function(){Calendar.show(s,t.popup)}),o.addEventListener("click",function(e){e.stopPropagation()}),o.parentNode.insertBefore(Calendar.getCalendar(s),o.nextSibling),this._pickers[e]={input:o,options:t},1},twoDigits:function(e){return 10>e?"0"+e:e},getDatePartsFromISODate:function(e){var t=new Date(e);return{year:t.getUTCFullYear(),monthIndex:t.getUTCMonth(),month:t.getUTCMonth()+1,monthStr:this.twoDigits(t.getUTCMonth()+1),day:t.getUTCDate(),dayStr:this.twoDigits(t.getUTCDate())}},getISODateFromDateParts:function(e,t,n){var i=parseInt(t)+1,o=this.twoDigits(i),r=this.twoDigits(n);return e+"-"+o+"-"+r},getSqlDateFromISODate:function(e){return e},getSqlDateFromDateParts:function(e,t,n){return this.getISODateFromDateParts(e,t,n)},getSqlDateFromEuropeanDate:function(e){if(/\d{2}(\.)\d{2}(\.)\d{4}/.test(e)){var t=e.split(".");return t[2]+"-"+t[1]+"-"+t[0]}return""},getEuropeanDateFromSqlDate:function(e){if(/\d{4}(\-)\d{2}(\-)\d{2}/.test(e)){var t=e.split("-");return t[2]+"."+t[1]+"."+t[0]}return""},getEuropeanDateFromISODate:function(e){var t=this.getDatePartsFromISODate(e);return t.dayStr+"."+t.monthStr+"."+t.year},getEuropeanDateFromDateParts:function(e,t,n){var i=parseInt(t)+1,o=this.twoDigits(i),r=this.twoDigits(n);return r+"."+o+"."+e},isNativeDatePickerSupported:function(){var e=document.createElement("input");e.setAttribute("type","date");var t="not-a-date";return e.setAttribute("value",t),e.value!==t}},BunnyValidate={errorClass:"has-danger",formGroupClass:"form-group",formLabelClass:"form-control-label",errorContainerTag:"small",errorContainerClass:"text-help",lang:{required:"Field '%s' ir required!",tel:"Field '%s' is not a valid telephone number!",email:"Field '%s' should be a valid e-mail address!",image:"Uploaded file '%s' should be an image (jpeg, png, bmp, gif, or svg)",maxlength:"Input '%s' length is too long, must be < '%maxlength'",minlength:"Input '%s' length is too short, must be > '%minlength'"},insertErrorContainer:function(e,t){return e.appendChild(t)},toggleErrorClass:function(e){e.classList.contains(this.errorClass)?e.classList.remove(this.errorClass):e.classList.add(this.errorClass)},createErrorContainer:function(){var e=document.createElement(this.errorContainerTag);return e.setAttribute("class",this.errorContainerClass),e},getErrorContainer:function(e){return e.querySelector("."+this.errorContainerClass)},removeErrorContainer:function(e){var t=this.getErrorContainer(e);null!==t&&(t.parentNode.removeChild(t),this.toggleErrorClass(e))},setErrorMessage:function(e,t){if("string"==typeof e)var n=document.getElementById(e);else var n=e;var i=this.getErrorContainer(n);if(null===i){var o=this.createErrorContainer();
this.toggleErrorClass(n),o.innerHTML=t,this.insertErrorContainer(n,o)}else i.innerHTML=t},validators:{maxlength:function(e){return null!==e.getAttribute("maxlength")&&e.value.length>e.getAttribute("maxlength")?{maxlength:e.getAttribute("maxlength")}:!0},minlength:function(e){return null!==e.getAttribute("minlength")&&e.value.length<e.getAttribute("minlength")?{minlength:e.getAttribute("minlength")}:!0},image:function(e){if("file"===e.getAttribute("type")&&"image/*"===e.getAttribute("accept")){if(0!==e.files.length){var t=["image/jpeg","image/png","image/bmp","image/gif","image/svg+xml"];return t.indexOf(e.files[0].type)>-1}return!0}return!0},email:function(e){if(e.value.length>0&&"email"===e.getAttribute("type")){var t=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;return t.test(e.value)}return!0},tel:function(e){if(e.value.length>0&&"tel"===e.getAttribute("type")){var t=/^[0-9\-\+\(\)\#\ \*]{6,20}$/;return t.test(e.value)}return!0},required:function(e){return null!==e.getAttribute("required")?""!==e.value:!0}},validate:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2],i=e,o=this;i.setAttribute("novalidate",""),i.addEventListener("submit",function(e){e.preventDefault();var r=!0,a=!1;i.querySelectorAll("."+o.formGroupClass).forEach(function(e){if(o.isFormGroupForInput(e)){var n=o.checkInput(e);n.valid===!1?(r=!1,o.setErrorMessage(e,n.msg),a||(void 0!==t.on_focus?t.on_focus(n.inputElements.input,e):o.focus(n.inputElements.input),a=!0)):o.removeErrorContainer(e)}}),r&&(void 0===n?i.submit():n())},!1)},getInputElementsByFormGroup:function(e){if("string"==typeof e)var t=document.getElementById(e);else var t=e;var n=t.querySelector("[name]"),i=t.getElementsByTagName("label")[0];return void 0===i&&(i=null),{formGroup:t,input:n,label:i}},isFormGroupForInput:function(e){var t=this.getInputElementsByFormGroup(e);return null!==t.input},_checkInputAgainstValidator:function(e,t,n){if(void 0===this.validators[n])return{valid:!1,msg:"ERROR: Validator not found"};var i=this.validators[n](e),o=!1,r={},a=!0,s="";if("boolean"!=typeof i)for(var l in i)o=!1,r[l]=i[l];else o=i;if(!o){var c="";if(null===t){var d=e.getAttribute("placeholder");null!==d&&(c=d)}else c=t.innerHTML;s=this.lang[n].replace("%s",c);for(var u in r)s=s.replace("%"+u,r[u]);a=!1}return{valid:a,msg:s}},checkInputAgainstValidator:function(e,t){var n=this.getInputElementsByFormGroup(e);return this._checkInputAgainstValidator(n.input,n.label,t)},checkInput:function(e){if("string"==typeof e)var t=document.getElementById(e);else var t=e;var n=this.getInputElementsByFormGroup(t),i=!0,o="";for(var r in this.validators){var a=this._checkInputAgainstValidator(n.input,n.label,r);if(a.valid===!1){i=!1,o=a.msg;break}}return{valid:i,msg:o,inputElements:n}},validateSection:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this,i=!0,o=!1;return e.querySelectorAll("."+this.formGroupClass).forEach(function(e){if(n.isFormGroupForInput(e)){var r=n.checkInput(e);r.valid===!1?(i=!1,n.setErrorMessage(e,r.msg),o||(void 0!==t.on_focus?t.on_focus(r.inputElements.input,e):n.focus(r.inputElements.input),o=!0)):n.removeErrorContainer(e)}}),i},focus:function(e){e.focus(),e.scrollIntoView(!1)}},Listeners={options:{},appDropdownClass:"app-dropdown",dateFields:["datetime_from","datetime_to"],autocompleteUrl:"/interests/?format=keyvalue&fields=name&limit=10&like[name]={search}",selectPromoImageButtonId:"select_promo_image",promoImageInputId:"promo_image",selectGalleryButtonId:"select_gallery",galleryInputId:"gallery",inviteFormId:"activity_invited",inviteButtonId:"activity_invited_submit_button",init:function(e){Lib.options=e,this.options=e},showCommentFormListener:function(){var e=this,t=document.querySelectorAll("."+this.options.createReplyClass+"[data-reply]");t.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e.options.decorator.showCommentForm(t)})})},submitCommentFormListener:function(){document.getElementsByClassName(this.options.postFormClass).forEach(function(e){e.addEventListener("keydown",function(t){13==t.keyCode&&"form"==e.tagName.toLowerCase()&&Lib.sendCommentForm(e)})})},deleteCommentListener:function(){var e=document.querySelectorAll("."+this.options.deleteCommentClass+"[data-comment]");e.forEach(function(e){var t=parseInt(e.getAttribute("data-comment"));e.addEventListener("click",function(e){e.stopPropagation(),Lib.deleteComment(t)})})},dropdownListener:function(){var e=document.getElementsByClassName(this.appDropdownClass);e.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation()})})},datePickerListener:function(){this.dateFields.forEach(function(e){document.getElementById(e)&&DatePicker.create(e,{onlyAsNativeFallback:!1})})},createLikeListener:function(e){e=e||{};var t=e.container||document,n=e.createLikeClass||this.options.createLikeClass,i=t.querySelectorAll("."+n+"[data-like]");i&&i.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),Lib.createLike(t,e)})})},checkSubmitListener:function(){var e=this;document.forms[this.options.appFormId].addEventListener("submit",function(t){return e.options.submitPermission?!0:(t.stopPropagation(),t.preventDefault(),!1)})},nextStepListener:function(){var e=this,t=document.getElementsByClassName(this.options.nextStepsClass),n=t.length,i=t.item(n-1);t.forEach(function(t){t.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation();var r=parseInt(t.getAttribute("data-step"));return r==e.options.decorator.createModelSteps?((r=n)&&i&&i.setAttribute("disabled","disabled"),Lib.createNewModel(t)):e.validateStep(r)&&e.options.decorator.toStep(r+1),!1})})},previousStepListener:function(){var e=this,t=document.getElementsByClassName(this.options.backStepsClass);t.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();var i=parseInt(t.getAttribute("data-step"));1==i?Lib.cancelCreation(t):i>1&&e.options.decorator.toStep(i-1)})})},addFormReplyListeners:function(e,t,n){var i=e.querySelector('[data-reply="'+n+'"]'),o=e.querySelector("svg");o.hasAttribute("role")&&o.removeAttribute("role"),this.addShowCommentFormListener(i),this.addFormKeyDownListener(t)},addShowCommentFormListener:function(e){var t=this,n=Lib.getNode(e);n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.options.decorator.showCommentForm(n)})},addCreateLikeListener:function(e){var t=Lib.getNode(e);t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),Lib.createLike(t)})},addFormKeyDownListener:function(e){var t=Lib.getNode(e);t.addEventListener("keydown",function(e){13==e.keyCode&&"form"==t.tagName.toLowerCase()&&Lib.sendCommentForm(t)})},autocompleteListener:function(e){Autocomplete.create(e,e+"_hidden","/"+this.options.prefix+this.autocompleteUrl,JSON.parse,{inputDelay:300})},moreButtonListener:function(e){var t=document.getElementById(e);t&&t.addEventListener("click",function(){Lib.more(e)})},promoButtonListener:function(){var e=this;document.getElementById(this.selectPromoImageButtonId)&&document.getElementById(this.selectPromoImageButtonId).addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),document.getElementById(e.promoImageInputId).click()})},galleryButtonListener:function(){var e=this;document.getElementById(this.selectGalleryButtonId)&&document.getElementById(this.selectGalleryButtonId).addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),document.getElementById(e.galleryInputId).click()})},showCommentsButtonListener:function(){var e=this,t=document.getElementById(this.options.showCommentsButtonId);t&&t.addEventListener("click",function(n){n.stopPropagation(),e.options.decorator.showComments(t)})},recommendButtonListener:function(){var e=document.getElementsByClassName(this.options.recommendButtonClass);e.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),Lib.recommend()})})},sendInvitesListener:function(){var e=document.forms[this.inviteFormId],t=document.getElementById(this.inviteButtonId);t&&t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),Lib.sendInvites(e)})},textareaListener:function(){var e=document.querySelectorAll("button[data-step]");e.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),Lib.insertCkeTextarea()})})},blockUserListener:function(){var e=document.getElementsByClassName(this.options.blockUserClass);e.forEach(function(e){e.addEventListener("click",function(t){t.stopPropagation(),e.hasAttribute("data-blocked")&&Lib.blockUser(e)})})},inviteToggleListeners:function(){var e=this,t=document.getElementsByClassName(this.options.inviteToggleClass);t.forEach(function(t){t.addEventListener("click",function(t){t.stopPropagation();var n=document.getElementsByClassName(e.options.inviteBlockClass);n.forEach(function(e){e.classList.toggle("hidden-xs-up")})})})},validateStep:function(e){return BunnyValidate.validateSection(this.options.sections[e])}},Decorator={hiddenClass:"hidden-xs-up",addInterest:"add-interest-buttons",createInterest:"create-interest-buttons",refreshButtons:function(e){var t="";e.forEach(function(e){t+='<button  class="app-s-close '+Interests.buttonStyle+'  refresh-buttons" data-item="'+e+'">'+e+"  </button>"}),document.getElementById(Interests.interests).innerHTML=t;for(var n=document.getElementsByClassName("refresh-buttons"),i=0;i<n.length;i++)n[i].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=this.getAttribute("data-item");Interests.remove(t)})},addInterestButtons:function(e){var t=document.createElement("div"),n="";if(e.forEach(function(e){var t=e.replace(/\s+/g,"_");"create"==Interests.mode&&Interests.testForSelected(t)||(n+='<button type="button" id="add_interest_buttons_'+t+'" class="'+Interests.buttonStyle+' add-interest-buttons" data-item="'+e+'">'+e+"  +</button>")}),t.innerHTML=n,document.getElementById(Interests.interestsAdd)){document.getElementById(Interests.interestsAdd).appendChild(t),Interests.interestPage++;for(var i=document.getElementsByClassName("add-interest-buttons"),o=0;o<i.length;o++)i[o].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=this.getAttribute("data-item");"edit"==Interests.mode?Interests.add(t):"create"==Interests.mode&&Interests.collectInterestsForCreation(t)})}},collectInterestsDecorator:function(e,t){var n,i=Interests,o=e.replace(/\s+/g,"_"),r=document.createElement("input");if(r.setAttribute("type","hidden"),r.setAttribute("name","interests[]"),r.setAttribute("id","interest_hidden_field_"+o),r.setAttribute("class",i.hiddenInterests),r.setAttribute("value",e),document.getElementById(i.interestsHiddenBlock)&&document.getElementById(i.interestsHiddenBlock).appendChild(r),document.getElementById("create_interest_buttons_"+o))document.getElementById("create_interest_buttons_"+o).classList.remove("hidden-xs-up");else{n='<button type="button" id="create_interest_buttons_'+o+'" class="app-s-close '+i.buttonStyle+' create-interest-buttons" data-item="'+e+'">'+e+" </button>";var a=document.createElement("div");a.style.display="inline-block",a.innerHTML=n,document.getElementById(i.interestsForCreationBlock)&&document.getElementById(i.interestsForCreationBlock).appendChild(a),t&&this.listSelected(),document.getElementById("create_interest_buttons_"+o).addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),document.getElementById("add_interest_buttons_"+o)&&document.getElementById("add_interest_buttons_"+o).classList.remove("hidden-xs-up"),document.getElementById(i.interestsHiddenBlock).removeChild(document.getElementById("interest_hidden_field_"+o)),document.getElementById("create_interest_buttons_"+o).classList.add("hidden-xs-up"),!1})}document.getElementById("add_interest_buttons_"+o)&&document.getElementById("add_interest_buttons_"+o).classList.add("hidden-xs-up")}},Interests={model:"user",current_user:null,current_adventure:null,current_review:null,selector:"autocomplete",autocompleteResolver:"bunny",last_input_data:"",interestPage:1,mode:"edit",fromInput:!1,list:!1,interests:"interests",interestsAdd:"interests-add",interestsHiddenBlock:"interests_hidden_block",hiddenInterests:"hidden_interests",firstInterestButton:"first_user_interest",interestsForCreationBlock:"interests_for_creation",interestsAutocompleteUrl:"/interests/?format=keyvalue&fields=name&limit=10&like[name]={search}",apiResultId:"create_interest_result",prefix:Server.project.apiPrefix,interestsListUrl:"/interests/list",addInterestUrl:"/interests/add/",editInterestUrl:"/interests/edit/",addToUserUrl:"/users/add-interest/",addToAdventureUrl:"/adventures/add-interest/",addToReviewUrl:"/review/add-interest/",refreshUserUrl:"/users/interests/",refreshAdventureUrl:"/adventures/interests/",refreshReviewUrl:"/review/interests/",removeFromUserUrl:"/users/remove-interest/",removeFromAdventureUrl:"/adventures/remove-interest/",removeFromReviewUrl:"/review/remove-interest/",buttonStyle:"btn btn-info m-t-1 m-r-1 m-b-1",addButton:"add_interest",removeButton:"remove_interest",loadMoreButton:"load_more_interest",createButton:"create_interest",editButton:"edit_interest",deleteButton:"delete_interest",init:function(e){this.options=e;var t=this;document.getElementById(this.selector)&&("awesomplete"===this.autocompleteResolver?Awesom.init(this.selector).fill():"bunny"===this.autocompleteResolver&&Listeners.autocompleteListener(this.selector),document.getElementById(this.selector).addEventListener("input",function(){t.checkInputChanges()}),document.getElementById(this.selector).addEventListener(t.autocompleteSelectEvent,function(){t.checkInputChanges()}),document.getElementById(this.selector).addEventListener("keydown",function(e){if(13==e.keyCode){var n=document.getElementById(t.selector).value;n.trim(),n.length&&n.length>3&&("edit"===this.mode?t.add(n):t.createFromInput())}}),this.refresh(),this.list&&this.listInterests(),document.getElementById(this.firstInterestButton)&&document.getElementById(this.firstInterestButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),n.length&&n.length>3&&("edit"===this.mode?t.add(n):t.createFromInput())}),document.getElementById(this.loadMoreButton)&&document.getElementById(this.loadMoreButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.listInterests()}),document.getElementById(this.addButton)&&document.getElementById(this.addButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),""!==n&&t.add(n)}),document.getElementById(this.removeButton)&&document.getElementById(this.removeButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),""!==n&&t.remove(n)}),document.getElementById(this.createButton)&&document.getElementById(this.createButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),""!==n&&t.createInterest(n)}),document.getElementById(this.editButton)&&document.getElementById(this.editButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),""!==n&&t.editInterest(n)}),document.getElementById(this.deleteButton)&&document.getElementById(this.deleteInterestButton).addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var n=document.getElementById(t.selector).value;n.trim(),""!==n&&t.deleteInterest(n)}))},checkInputChanges:function(){var e=this,t=document.getElementById(this.selector).value;t.trim();var n="/"+this.prefix+this.interestsListUrl;Ajax$1.get(n,function(n){var i=JSON.parse(n).map(function(e){return e.name});i.indexOf(t)>-1&&(e.last_input_data=t)})},add:function(e){var t,n=this;switch(e=e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\//g,""),n.model){case"user":t="/"+this.prefix+this.addToUserUrl+e+"/"+this.current_user;break;case"adventure":t="/"+this.prefix+this.addToAdventureUrl+e+"/"+this.current_adventure;break;case"review":t="/"+this.prefix+this.addToReviewUrl+e+"/"+this.current_review}Ajax$1.get(t,function(t){var i=JSON.parse(t);"added"===i.action?(Awesom.fill(),n.apiResult(e,i.action,i.message),n.refresh(),n.interestPage=1,document.getElementById(n.interestsAdd)&&(document.getElementById(n.interestsAdd).innerHTML="",n.listInterests())):"overflow"!==i.action&&"error"!==i.action||n.apiResult(e,i.action,i.message)})},refresh:function(){var e=this;if(!document.getElementById(e.interests))return!1;var t;switch(this.model){case"user":t="/"+this.prefix+this.refreshUserUrl+this.current_user;break;case"adventure":t="/"+this.prefix+this.refreshAdventureUrl+this.current_adventure;break;case"review":t="/"+this.prefix+this.refreshReviewUrl+this.current_review}Ajax$1.get(t,function(e){var t=JSON.parse(e).map(function(e){return e.name});Decorator.refreshButtons(t)})},remove:function(e){var t,n=this;switch(this.model){case"user":t="/"+this.prefix+this.removeFromUserUrl+e+"/"+this.current_user;break;case"adventure":t="/"+this.prefix+this.removeFromAdventureUrl+e+"/"+this.current_adventure;break;case"review":t="/"+this.prefix+this.removeInterestFromReviewUrl+e+"/"+this.current_review}Ajax$1.get(t,function(t){var i=JSON.parse(t);"removed"===i.action?(Awesom.fill(),document.getElementById(n.selector).value="",n.apiResult(e,i.action,null),n.refresh(),n.interestPage=1,document.getElementById(n.interestsAdd)&&(document.getElementById(n.interestsAdd).innerHTML="",n.listInterests())):"error"===i.action&&n.apiResult(e,i.action,i.message)})},listInterests:function(){if(0==this.list)return!1;var e,t=this;switch(this.model){case"user":e="/"+this.prefix+t.refreshUserUrl+this.current_user+"/"+this.interestPage;break;case"adventure":e="/"+this.prefix+t.refreshAdventureUrl+this.current_adventure+"/"+this.interestPage;break;case"review":e="/"+this.prefix+t.refreshReviewUrl+this.current_review+"/"+this.interestPage}Ajax$1.get(e,function(e){var t=JSON.parse(e).map(function(e){return e.name});Decorator.addInterestButtons(t)})},listSelected:function(){for(var e,t,n=this,i=document.getElementsByClassName(n.hiddenInterests),o="",r=0;r<i.length;r++)e=i[r].getAttribute("value"),t=e.replace(/\s+/g,"_"),o+='<button id="add-interest-buttons-'+t+'" class="'+n.buttonStyle+' add-interest-buttons" data-item="'+e+'">'+e+"  +</button>";var a=document.createElement("div");a.style.display="inline-block",a.innerHTML=o,document.getElementById(n.interestsAdd)&&(document.getElementById(n.interestsAdd).innerHTML="",document.getElementById(n.interestsAdd).appendChild(a));for(var s=document.getElementsByClassName("add-interest-buttons"),l=0;l<s.length;l++)s[l].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=this.getAttribute("data-item");"edit"==mode?n.add(t):"create"==mode&&n.collectInterestsForCreation(t)}),s[l].classList.add("hidden-xs-up");this.interestPage=1},collectInterestsForCreation:function(e,t){var n=this;t=t||null;var i=document.getElementById(n.interestsHiddenBlock),o=document.getElementsByClassName(n.hiddenInterests);o.length<15&&i&&Decorator.collectInterestsDecorator(e)},testForSelected:function(e){for(var t,n,i=this,o=document.getElementsByClassName(i.hiddenInterests),r=!1,a=0;a<o.length;a++)t=o[a].getAttribute("value"),n=t.replace(/\s+/g,"_"),n==e&&(r=!0);return r},createInterest:function(e){var t=this;if(""==e)return!1;var n="/"+this.prefix+this.addInterestUrl+e;Ajax$1.get(n,function(n){var i=JSON.parse(n);"success"==i.action&&(Awesom.fill(),t.collectInterestsForCreation(e,!0),t.interestPage=1,t.listInterests())})},editInterest:function(e){var t,n=this,i=this.last_input_data,o="/"+this.prefix+this.editInterestUrl+i+"/"+e;Ajax$1.get(o,function(o){var r=JSON.parse(o);"edited"===r.action?(Awesom.fill(),t="Interest "+i+" successfully renamed to "+e,n.apiResult(e,r.action,t)):"not found"===r.action&&(t="Interest "+i+" not found",n.apiResult(e,r.action,t))})},deleteInterest:function(e){var t=this;e=e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\//g,"");var n="/"+this.prefix+this.interestsUrl+e+"/delete";Ajax$1.get(n,function(n){var i=JSON.parse(n);"deleted"===i.action?(Awesom.fill(),t.apiResult(e,i.action,null)):"not fount"===i.action&&t.apiResult(e,i.action,null)})},createFromInput:function(){var e=this,t=document.getElementById(e.selector).value;if(""==t)return!1;var n=t.replace(/\s+/g,"_");if(this.testForSelected(n))return!0;var i="/"+this.prefix+e.interestsListUrl;Ajax$1.get(i,function(n){var i=JSON.parse(n).map(function(e){return e.name});i.indexOf(t)>-1?(e.collectInterestsForCreation(t),e.interestPage=1,e.listInterests()):e.createInterest(t)})},apiResult:function(e,t,n){var i,o=this,r=document.getElementById(o.apiResultId);switch(r.classList.remove("hidden-xs-up"),t){case"success":i='You interest "'+e+'" successfully created',r.classList.add("alert-success"),r.innerText=document.createTextNode(i).textContent;break;case"added":i='You interest "'+e+'" successfully added',r.classList.add("alert-success"),r.innerText=document.createTextNode(i).textContent;break;case"edited":i=n,r.classList.add("alert-success"),r.innerText=document.createTextNode(i).textContent;break;case"exist":i='Interest "'+e+'" already  exist',r.classList.add("alert-info"),r.innerText=document.createTextNode(i).textContent;break;case"overflow":i=n,r.classList.add("alert-warning"),r.innerText=document.createTextNode(i).textContent;break;case"not found":i=n,r.classList.add("alert-warning"),r.innerText=document.createTextNode(i).textContent;break;case"removed":i='Interest "'+e+'" removed',r.classList.add("alert-warning"),r.innerText=document.createTextNode(i).textContent;break;case"error":i=n,r.classList.add("alert-danger"),r.innerText=document.createTextNode(i).textContent,document.querySelector("#"+o.selector).value=""}setTimeout(function(){r.innerText=document.createTextNode("").textContent,r.className="hidden-xs-up p-x-3 p-y-1 m-b-2"},4e3)}},Radiobox={create:function(e,t,n){var i=this;document.getElementsByClassName(e).forEach(function(o){var r=o.getElementsByClassName(t)[0];if(void 0!==r){var a=o.getElementsByTagName("input")[0];a.checked&&!r.classList.contains(n)?(r.classList.add(n),a.value=1):a.checked?a.value=1:a.value=0,a.addEventListener("change",function(o){var r=o.target||o.srcElement;r.checked&&i.refreshCheckValue(e,t,n)})}})},refreshCheckValue:function(e,t,n){document.getElementsByClassName(e).forEach(function(e){var i=e.getElementsByClassName(t)[0];if(void 0!==i){var o=e.getElementsByTagName("input")[0];o.checked?(i.classList.add(n),o.value=1):(i.classList.remove(n),o.value=0)}})}},FileUploads=function(){var e=null,t=function(e){return"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))?e:document.getElementById(e)},n=function(e,n){e=t(e);var i=document.createElement("img");return i.setAttribute("id",n),i.setAttribute("src",""),i.setAttribute("alt","Promo image preview"),"DIV"===e.tagName?(e.appendChild(i),i):!1};return{previewContainer:"preview_container",download:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=new XMLHttpRequest;i.onload=function(){if(4===this.readyState)if(200===this.status){var e=this.response;t(e)}else null!==n&&n(this.response,this.status)},i.open("GET",e,!0),i.responseType="blob",i.send()},addToForm:function(e,n,i){var o=void 0,r=void 0;return o=t(e),r=new FormData(o),r.append(n,i)},previewImageFromInput:function(i,o){var r=void 0,a=void 0;r=t(i),a=t(o),e=a.id?a.id:null,r=r?r:n(this.previewContainer,i),r.src&&(r.src=URL.createObjectURL(a.files[0]))},previewImageFromBlob:function(e,n){var i=void 0;i=t(e),i.src=URL.createObjectURL(n)},attachImagePreviewEvent:function(e,n){var i=this,o=t(n);o.addEventListener("change",function(){i.previewImageFromInput(e,o)})},addCleanEventListener:function(n,i){var o=this,r=t(n);r.addEventListener(i,function(n){n.preventDefault(),n.stopPropagation();var i=o,r=document.querySelector("#"+i.previewContainer+" > img"),a=t(i.previewContainer);if(a.removeChild(r),e){var s=document.getElementById(e);s.value=null}return!1})}}}(),Element={getCurrentDocumentPosition:function(){return Math.abs(document.body.getBoundingClientRect().y)},getPosition:function(e){var t=0;if(e.offsetParent){do t+=e.offsetTop;while(e=e.offsetParent);return t}return 0},scrollTo:function(e){function t(e){d=e-c,window.scrollTo(0,a.easing(d,r,s,l)),l>d?requestAnimationFrame(t):n()}function n(){window.scrollTo(0,r+s),"function"==typeof a.callback&&a.callback()}function i(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=window.pageYOffset,a={duration:o.duration||750,offset:o.offset||0,callback:o.callback,easing:o.easing||i},s=0;s="string"==typeof e?a.offset+document.querySelector(e).getBoundingClientRect().top:"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))?e.getBoundingClientRect().top:e;var l=0;l="function"==typeof a.duration?a.duration(s):a.duration;var c=0,d=0;s+=a.offset,requestAnimationFrame(function(e){c=e,t(e)})}},Search$1=Search={_overlay:null,_searchId:"navbar_search",_inputId:"navbar_search_input",init:function(){this._attachEventListeners()},_attachEventListeners:function(){var e=this;null!==this.getSearchInput()&&(this.getSearchInput().addEventListener("open",function(){e._showOverlay()}),this.getSearchInput().addEventListener("close",function(){e._hideOverlay()}))},getSearch:function(){return document.getElementById(this._searchId)},getSearchInput:function(){return document.getElementById(this._inputId)},showSearch:function(){this.getSearch().classList.add("open"),this._showOverlay()},hideSearch:function(){this.getSearch().classList.remove("open"),this._hideOverlay()},_showOverlay:function(){var e=document.createElement("div");e.classList.add("app-overlay"),this._overlay=e,document.body.appendChild(e)},_hideOverlay:function(){document.body.removeChild(this._overlay)}},Navbar={el:document.getElementById("navbar"),mobileEl:document.getElementById("navbar-mobile"),overlayEl:null,mobileActiveClass:"active",mobileOverlayClass:"app-overlay",mobileOverlayId:"navbar_mobile_overlay",mobileHamburgerSelector:'[data-id="navbar-hamburger"]',init:function(){this.attachHamburgerClickEvent(),this.initSearch()},getHeight:function(){return this.el.clientHeight},toggleMobileNav:function(){this.mobileEl.classList.toggle(this.mobileActiveClass),this.toggleMobileOverlay()},toggleMobileOverlay:function(){null===this.overlayEl?(this.overlayEl=document.createElement("div"),this.overlayEl.id=this.mobileOverlayId,this.overlayEl.classList.add(this.mobileOverlayClass),document.body.appendChild(this.overlayEl),this.attachMobileOverlayClickEvent(this.overlayEl)):(document.body.removeChild(this.overlayEl),this.overlayEl=null)},attachMobileOverlayClickEvent:function(e){var t=this;e.addEventListener("click",function(){t.toggleMobileNav()})},attachHamburgerClickEvent:function(){var e=this;document.querySelectorAll(this.mobileHamburgerSelector).forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),e.toggleMobileNav()})})},initSearch:function(){Search$1.init()}},Decorator$1={createModelSteps:3,contentPage:2,hiddenClass:"hidden-xs-up",sectionNewClassName:"app-card app-p-card m-x-0 row",sectionClassName:"col-xs-12 p-t-2 app-card-b-divide",responseClassName:"row app-card m-x-0 app-p-card app-review-m-t-quarter hidden-xs-up",init:function(e){this.modelStepPrefix=e.modelStepPrefix,this.postContainerId=e.postContainerId,this.appTopId=e.appTopId,this.appRowsId=e.appRowsId,this.postFormClass=e.postFormClass,this.replyClass=e.replyClass,this.createReplyClass=e.createReplyClass,this.responseClass=e.responseClass,this.likeClass=e.likeClass,this.createLikeClass=e.createLikeClass,this.recommendButtonId=e.recommendButtonId,this.likeModelClass=e.likeModelClass,this.createModelLikeClass=e.createModelLikeClass,this.prefix=e.prefix,this.likeModelUrl=e.likeReviewUrl,this.recommendButtonClass=e.recommendButtonClass,this.model=e.model},newCommentDecorator:function(e,t){var n=void 0,i=document.createElement("div");if(t.newPost){if(n=document.querySelector("#"+this.postContainerId),!n)return!1;var o=document.createElement("div");o.classList.add("m-b-2"),i.className=this.sectionNewClassName,i.setAttribute("data-post",t.postId),i.innerHTML=t.html;var r=document.createElement("div");r.className=this.responseClassName,r.innerHTML=t.replyTitleHtml,o.appendChild(i),o.appendChild(r),n.appendChild(o);var a=i.querySelector("."+this.postFormClass);Listeners.addFormReplyListeners(i,a,t.postId)}else{if(n=document.querySelector('[data-post="'+e+'"]'),!n)return!1;var s=void 0,l=n.parentNode;i.className=this.sectionClassName,s=l.getElementsByClassName(this.responseClass),s.length>0&&(i.innerHTML=t.html,s[0].appendChild(i),s[0].parentNode.classList.remove(this.hiddenClass));var c=document.querySelector('[data-like="'+t.postId+'"]');Listeners.addCreateLikeListener(c)}var d=document.querySelector("."+this.replyClass+'[data-reply="'+e+'"]');d&&(d.innerHTML=t.count)},recommendDecorator:function(){var e=document.getElementsByClassName(this.recommendButtonClass);e.forEach(function(e){e.removeAttribute("role"),e.classList.add("active")})},likeDecorator:function(e,t){t=t||{};var n=t.likeClass||this.likeClass,i=t.createLikeClass||this.createLikeClass;if(e.result){var o=t.id||e.id;if(!o)return!1;var r=document.querySelector("."+n+'[data-like="'+o+'"]'),a=document.querySelector("."+i+'[data-like="'+o+'"]');"object"==("undefined"==typeof a?"undefined":babelHelpers["typeof"](a))&&(a.setAttribute("data-liked","1"),a.getElementsByTagName("svg")[0].classList.add("active")),r.innerHTML=e.count}else{var s=document.querySelector("."+i+'[data-like="'+id+'"] > svg');"object"==("undefined"==typeof s?"undefined":babelHelpers["typeof"](s))&&s.removeAttribute("role")}},showCommentForm:function(e){var t=e.getAttribute("data-reply"),n=document.querySelector('form[data-form="'+t+'"]');n&&n.parentNode.classList.toggle(this.hiddenClass)},showComments:function(e){var t=e.parentNode,n=t.nextSibling,i=n.nextSibling;i.classList.remove(this.hiddenClass),n.classList.remove(this.hiddenClass),t.classList.add(this.hiddenClass)},toStep:function(e){for(var t=this.modelStepPrefix,n=1;n<this.createModelSteps+1;n++){var i=document.getElementById(t+n);i&&i.classList.add(this.hiddenClass)}var o=document.getElementById(this.appTopId);return o.innerHTML=e,document.getElementById(t+e).classList.remove(this.hiddenClass),Element.scrollTo(document.getElementsByTagName("section")[0],{duration:500,offset:-Navbar.getHeight()}),!1},moreButtonDecorator:function(e,t,n){if(1==e.success){var i=document.getElementById(this.appRowsId),o=document.createElement("div");o.innerHTML=e.html;var r={likeClass:this.likeModelClass,createLikeClass:this.createModelLikeClass,url:"/"+this.prefix+this.likeModelUrl,container:o};Listeners.createLikeListener(r),i.appendChild(o),n.remove(t),t.removeAttribute("disabled"),this.contentPage>=e.lastPage&&t.classList.add(this.hiddenClass),this.contentPage++}},inviteDecorator:function(e){}},Geo={resolveLocationData:function(e,t){var n=this;this.nameSelector=t.nameSelector||null,this.locationSelector=t.locationSelector||null,this.idSelector=t.idSelector||null,this.latSelector=t.latSelector||null,this.lngSelector=t.lngSelector||null,this.countrySelector=t.countrySelector||null,this.name=document.getElementById(this.nameSelector).value,this.resolver=e,this.callResolver(),document.getElementById(this.nameSelector)&&document.getElementById(this.nameSelector).addEventListener("change",function(){setTimeout(function(){n.name=n.name.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g,"+"),
n.callResolver()},200)})},callResolver:function(){this.resolver(this.name,this.locationSelector,this.idSelector,this.latSelector,this.lngSelector,this.countrySelector)}},GoogleGeo={resolver:function(e,t,n,i,o,r){var a="https://maps.google.com/maps/api/geocode/json?address="+e;Ajax$1.get(a,function(e){var a=JSON.parse(e),s=a.results[0].geometry.location.lat,l=a.results[0].geometry.location.lng,c=null,d=a.results[0].address_components;d.forEach(function(e){Array.isArray(e.types)&&e.types.forEach(function(t){"country"==t&&(c=e.long_name)})}),c&&document.getElementById(r)&&(document.getElementById(r).innerHTML=c),document.getElementById(i)&&(document.getElementById(i).value=s),document.getElementById(o)&&(document.getElementById(o).value=l),document.getElementById(t)&&(document.getElementById(t).value="POINT("+s+" , "+l+")"),document.getElementById(n)&&(document.getElementById(n).value=a.results[0].place_id)},function(e){},{})},init:function(e,t){var n=this,i=e.geoOption;t=t||i.nameSelector;var o=new google.maps.places.Autocomplete(document.getElementById(t),{types:["geocode"]});google.maps.event.addListener(o,"place_changed",function(){return n.resolveLocationData(i)})},resolveLocationData:function(e){Geo.resolveLocationData(this.resolver,e)}},GoogleProfile={handleClientLoad:function(){gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:Server.env.googleClientId,fetch_basic_profile:!0,scope:"profile"})})},login:function(e,t){auth2.signIn().then(function(){return e(auth2.currentUser.get())},function(){t()})},getData:function(e,t){var n=e.getBasicProfile(),i={};i.provider="google",i.id=n.getId(),i.email=n.getEmail(),i.first_name=n.getGivenName(),i.last_name=n.getFamilyName(),i.image=n.getImageUrl(),i.token=e.getAuthResponse().id_token,t(i)}},FormList$1=FormList={addButtonId:"add_invite_input",container:null,inputContainerClass:"app-form-list-item",inputContainerClassName:"form-group row m-t-2 app-form-list-item",closerLinkClassName:"pull-xs-left app-s-close m-x-2 app-file-list-closer",inputName:"",init:function(e){var t=document.getElementById(e);if(t instanceof HTMLElement){var n=t.querySelector("input"),i=t.querySelector("#"+this.addButtonId);if(n instanceof HTMLElement&&i instanceof HTMLElement)return this.container=t,n.hasAttribute("name")&&(this.inputName=n.getAttribute("name"),-1===this.inputName.indexOf("[]")&&(this.inputName+="[]",n.setAttribute("name",this.inputName))),this.attachAddEventListener(e),!0}throw new Error("Input or button not found")},attachAddEventListener:function(e){var t=this,n=document.getElementById(e);n instanceof HTMLElement&&!function(){var i=t,o=n.querySelector("#"+t.addButtonId);o&&o.addEventListener("click",function(t){t.stopPropagation(),i.addInput(e)})}()},getInputs:function(e){var t=this,n=document.getElementById(e);if(n instanceof HTMLElement){var i=function(){var e=t.container.querySelectorAll("input"),n=[];return e.forEach(function(e){n.push(e)}),{v:n}}();if("object"===("undefined"==typeof i?"undefined":babelHelpers["typeof"](i)))return i.v}},attachDeleteEventListener:function(e){var t=this,n=e.closest("."+this.inputContainerClass);e instanceof HTMLElement&&e.addEventListener("click",function(e){e.stopPropagation(),n instanceof HTMLElement&&t.removeInput(n)})},createInputContainer:function(){var e=document.createElement("div");return e.className=this.inputContainerClassName,e},createInput:function(){var e=document.createElement("div"),t=document.createElement("input");return e.classList.add("col-xs-9"),t.setAttribute("name",this.inputName),t.setAttribute("type","email"),t.classList.add("form-control"),e.appendChild(t),e},createCloser:function(){var e=document.createElement("div"),t=document.createElement("a");return e.classList.add("col-xs-3"),t.className=this.closerLinkClassName,t.setAttribute("href","#"),e.appendChild(t),e},insertInputContainer:function(e,t){var n=document.getElementById(e);t instanceof HTMLElement&&n instanceof HTMLElement&&n.appendChild(t)},addInput:function(e){var t=this.createInputContainer(),n=this.createInput(),i=this.createCloser();t.appendChild(i),t.appendChild(n),this.insertInputContainer(e,t),this.makeInputDeletable(n)},removeInput:function(e){e instanceof HTMLElement&&this.container.removeChild(e)},makeInputDeletable:function(e){var t=this.getCloseBtnByInput(e);this.attachDeleteEventListener(t)},getCloseBtnByInput:function(e){var t=e.closest("."+this.inputContainerClass);return t.querySelector("a")}},ActivitiesController={options:{decorator:Decorator$1,prefix:Server.project.apiPrefix,model:"adventure",likeModelUrl:"/adventures/like/",likeUrl:"/activity_comments/like/",replyUrl:"/activity_comments/reply/",deleteReplyUrl:"/activity_comments/delete/",contentUrl:"/activities?page=",reloadUrl:"/activities",blockUserUrl:"/users/block/",appFormId:"add_edit_activities_form",appTopId:"app_new_activities_top_step",appRowsId:"app_activity_rows",moreButtonId:"app_button_more",postContainerId:"app_activity_post_container",modelStepPrefix:"app_new_activities_step",submitPermission:!1,withGallery:!1,postFormClass:"app-activity-response-form",createReplyClass:"app-activity-reply",likeClass:"app-activity-like-data",createLikeClass:"app-activity-like",backStepsClass:"app-new-activities-back",nextStepsClass:"app-new-activities-next",replyClass:"app-activity-reply-data",responseClass:"app-responses-block",deleteCommentClass:"app-delete-comment",recommendButtonClass:"app-activity-recommend",blockUserClass:"app-block-user",inviteToggleClass:"app-activity-invite-toggle",inviteBlockClass:"app-activity-invite-block",geoOption:{nameSelector:"place_name",locationSelector:"place_location",idSelector:"place_id",latSelector:"location_lat",lngSelector:"location_lng",countrySelector:"country_name"},sections:{1:document.getElementById("app_new_activities_step1"),2:document.getElementById("app_new_activities_step2"),3:document.getElementById("app_new_activities_step3"),4:document.getElementById("app_new_activities_step4"),5:document.getElementById("app_new_activities_step5")},current_user:null,current_activity:null},activities:function(){Checkbox.create("app-checkbox-label","app-checkbox","checked");var e={likeClass:this.options.likeModelClass,createLikeClass:this.options.createModelLikeClass,url:"/"+this.options.prefix+this.options.likeModelUrl};Listeners.init(this.options),Decorator$1.init(this.options),Listeners.moreButtonListener(this.options.moreButtonId),Listeners.createLikeListener(e)},showAdd:function(){Lib.setRequired("description");var e=document.querySelector("[data-user]");e&&(this.options.current_user=e.getAttribute("data-user"));var t=document.querySelector("[data-review]");t&&(this.options.current_activity=t.getAttribute("data-adventure")),Interests.selector="new_activity_interest_autocomplete",Interests.firstInterestButton="add_interest_to_new_activity",Interests.interestsHiddenBlock="interests_hidden_block",Interests.interestsForCreationBlock="interests_for_creation",Interests.mode="create",Interests.model="adventure",Interests.buttonStyle="app-tag",Listeners.init(this.options),Decorator$1.init(this.options),Decorator$1.createModelSteps=5,Listeners.checkSubmitListener(),Listeners.textareaListener(),Listeners.nextStepListener(),Listeners.previousStepListener(),Listeners.promoButtonListener(),Listeners.inviteToggleListeners(),Checkbox.create("app-checkbox-label","app-checkbox","checked"),Radiobox.create("app-radio-label","app-radio","checked"),FileUploads.attachImagePreviewEvent("promo_image_image","promo_image"),GoogleGeo.init(this.options),Interests.autocompleteResolver="bunny",Interests.init(),FormList$1.init("app_invite_inputs_block")},activity:function(){var e=document.querySelector("[data-user]");e&&(this.options.current_user=e.getAttribute("data-user"));var t=document.querySelector("[data-review]");t&&(this.options.current_activity=t.getAttribute("data-adventure")),Interests.selector="activity_interest_autocomplete",Interests.addInterestToAdventureButton="add_interest_to_activity",Interests.interestsHiddenBlock="interests_hidden_block",Interests.interestsForCreationBlock="interests_for_creation",Interests.buttonStyle="app-tag",Interests.model="adventure",Listeners.init(this.options),Decorator$1.init(this.options),Checkbox.create("app-checkbox-label","app-checkbox","checked"),Listeners.showCommentFormListener(),Listeners.submitCommentFormListener(),Listeners.createLikeListener(),Listeners.moreButtonListener(this.options.moreButtonId),Listeners.deleteCommentListener(),Listeners.blockUserListener(),Interests.autocompleteResolver="bunny",Interests.init()}},Gallery={imageContainerId:"app_gallery_image_container",galleryContainerId:"app_gallery",prev:"app_gallery_prev_button",next:"app_gallery_next_button",numCurrent:"app_gallery_image_current",numCount:"app_gallery_image_count",hiddenClass:"hidden-xs-up",current:0,images:[],init:function(){var e=document.getElementById(this.imageContainerId);this.images=e.getElementsByTagName("div"),this.toStep(),this.setCurrent(),document.getElementById(this.numCount).innerHTML=this.images.length.toString(),this.nextListener(),this.previousListener()},nextListener:function(){var e=this;document.getElementById(this.next).addEventListener("click",function(t){t.stopPropagation(),t.preventDefault();var n=e.images.length-1;0<=e.current&&e.current<n?e.current++:e.current=0,e.toStep(),e.setCurrent()})},previousListener:function(){var e=this;document.getElementById(this.prev).addEventListener("click",function(t){t.stopPropagation(),t.preventDefault();var n=e.images.length-1;0<e.current&&e.current<=n?e.current--:e.current=n,e.toStep(),e.setCurrent()})},toStep:function(){var e=this;this.images.forEach(function(t){t.classList.add(e.hiddenClass)}),this.images[this.current].classList.remove(this.hiddenClass)},setCurrent:function(){document.getElementById(this.numCurrent).innerHTML=(this.current+1).toString()}},ReviewsController={options:{decorator:Decorator$1,prefix:Server.project.apiPrefix,model:"review",likeModelUrl:"/reviews/like/",likeUrl:"/review_comments/like/",replyUrl:"/review_comments/reply/",deleteReplyUrl:"/review_comments/delete/",contentUrl:"/reviews?page=",inviteUrl:"/adventures/invite/",reloadUrl:"/reviews",recommendUrl:"/reviews/recommend/",blockUserUrl:"/users/block/",appFormId:"add_edit_reviews_form",appTopId:"app_new_reviews_top_step",appRowsId:"app_review_rows",moreButtonId:"app_button_more",showCommentsButtonId:"app_review_show_more_comments",postContainerId:"app_review_post_container",recommendButtonId:"app_recommended",modelStepPrefix:"app_new_reviews_step",submitPermission:!1,withGallery:!0,postFormClass:"app-open-review-response-form",createReplyClass:"app-open-review-reply",likeClass:"app-open-review-like-data",likeModelClass:"app-review-like-data",createLikeClass:"app-open-review-like",createModelLikeClass:"app-review-like",backStepsClass:"app-new-reviews-back",nextStepsClass:"app-new-reviews-next",replyClass:"app-open-review-reply-data",responseClass:"app-responses-block",deleteCommentClass:"app-delete-comment",recommendButtonClass:"app-open-review-recommend",blockUserClass:"app-block-user",geoOption:{nameSelector:"place_name",locationSelector:"place_location",idSelector:"place_id",latSelector:"location_lat",lngSelector:"location_lng",countrySelector:"country_name"},sections:{1:document.getElementById("app_new_reviews_step1"),2:document.getElementById("app_new_reviews_step2"),3:document.getElementById("app_new_reviews_step3")},current_user:null,current_review:null},reviews:function(){Checkbox.create("app-checkbox-label","app-checkbox","checked");var e={likeClass:this.options.likeModelClass,createLikeClass:this.options.createModelLikeClass,url:"/"+this.options.prefix+this.options.likeModelUrl};Listeners.init(this.options),Decorator$1.init(this.options),Listeners.moreButtonListener(this.options.moreButtonId),Listeners.createLikeListener(e)},showAdd:function(){var e=document.querySelector("[data-user]");e&&(this.options.current_user=e.getAttribute("data-user"),Interests.current_user=e);var t=document.querySelector("[data-review]");t&&(this.options.current_review=t.getAttribute("data-review"),Interests.current_review=t),Interests.selector="new_review_interest_autocomplete",Interests.firstInterestButton="add_interest_to_new_review",Interests.interestsHiddenBlock="interests_hidden_block",Interests.interestsForCreationBlock="interests_for_creation",Interests.model="review",Interests.mode="create",Interests.buttonStyle="app-tag",Lib.setRequired("description"),Listeners.init(this.options),Decorator$1.init(this.options),Listeners.checkSubmitListener(),Listeners.textareaListener(),Listeners.nextStepListener(),Listeners.previousStepListener(),Listeners.promoButtonListener(),Listeners.galleryButtonListener(),FileUploads.attachImagePreviewEvent("promo_image_image","promo_image"),GalleryUploads.collectFilesListener(),GoogleGeo.init(this.options),Interests.autocompleteResolver="bunny",Interests.init()},review:function(){var e=this,t=document.querySelector("[data-user]");t&&(this.options.current_user=t.getAttribute("data-user"));var n=document.querySelector("[data-review]");n&&(this.options.current_review=n.getAttribute("data-review")),this.options.contentUrl="/"+this.options.prefix+"/reviews/related/"+this.options.current_review+"?page=",Gallery.init(),Listeners.init(this.options),Decorator$1.init(this.options),Listeners.showCommentFormListener(),Listeners.submitCommentFormListener(),Listeners.createLikeListener();var i={likeClass:e.options.likeReviewClass,createLikeClass:e.options.createReviewLikeClass,url:"/"+e.options.prefix+e.options.likeReviewUrl};Listeners.createLikeListener(i),Listeners.moreButtonListener(this.options.moreButtonId),Listeners.showCommentsButtonListener(),Listeners.recommendButtonListener(),Listeners.deleteCommentListener(),Listeners.blockUserListener()}};BunnyFormData.prototype._initSingleInput=function(e){"TEXTAREA"===e.tagName&&(e.type="textarea");var t=e.type.toLowerCase();t=t.charAt(0).toUpperCase()+t.slice(1),t="_formControlParser"+t,void 0!==this[t]?this[t](e):this._formControlParserDefault(e)},BunnyFormData.prototype._formControlParserDefault=function(e){void 0!==this._collection[e.name]?(Array.isArray(this._collection[e.name])||(this._collection[e.name]=[this._collection[e.name]]),this._collection[e.name].push(e.value)):this._collection[e.name]=e.value},BunnyFormData.prototype._formControlParserRadio=function(e){e.checked&&(this._collection[e.name]=e.value)},BunnyFormData.prototype._formControlParserCheckbox=function(e){void 0===this._collection[e.name]?e.checked?this._collection[e.name]=e.value:this._collection[e.name]="":e.checked&&(Array.isArray(this._collection[e.name])||(this._collection[e.name]=[this._collection[e.name]]),this._collection[e.name].push(e.value))},BunnyFormData.prototype._formControlParserFile=function(e){this._collection[e.name]=void 0===e.files[0]||null===e.files[0]?"":e.files[0]},BunnyFormData.prototype.getInputs=function(){return Object.getOwnPropertyDescriptor(this._form.constructor.prototype,"elements").get.call(this._form)},BunnyFormData.prototype.getNamedInputs=function(){for(var e=this.getInputs(),t=nonEnumKeys(e),n={},i=0;i<t.length;i++){var o=t[i];n[o]=e[o]}return n},BunnyFormData.prototype.getNodeLists=function(){var e=this.getNamedInputs(),t={};for(var n in e)this.isNodeList(n)&&(t[n]=e[n]);return t},BunnyFormData.prototype.getRadioLists=function(){var e=this.getNodeLists(),t={};for(var n in e)"radio"===e[n][0].type&&(t[n]=e[n]);return t},BunnyFormData.prototype.getInput=function(e){return Object.getOwnPropertyDescriptor(this._form.constructor.prototype,"elements").get.call(this._form)[e]},BunnyFormData.prototype.get=function(e){return void 0===this._collection[e]?null:this._collection[e]},BunnyFormData.prototype.set=function(e,t){this._collection[e]=t},BunnyFormData.prototype.setCheckbox=function(e,t,n){if(this.has(e)&&!this.empty(e))if(n)this.isArray(e)?-1===this._collection[e].indexOf(t)&&this._collection[e].push(t):this._collection[e]!==t&&(this._collection[e]=[this._collection[e]],this._collection[e].push(t));else if(this.isArray(e)){var i=this._collection[e].indexOf(t);-1!==i&&(1===this._collection[e].length?this._collection[e]="":this._collection[e].splice(i,1))}else this._collection[e]===t&&(this._collection[e]="");else this._collection[e]=t},BunnyFormData.prototype.has=function(e){return void 0!==this._collection[e]},BunnyFormData.prototype.empty=function(e){return 0===this._collection[e].length},BunnyFormData.prototype.isArray=function(e){return Array.isArray(this._collection[e])},BunnyFormData.prototype.isNodeList=function(e){var t=this.getInput(e);return t instanceof RadioNodeList},BunnyFormData.prototype.append=function(e,t){if(void 0===this._collection[e])this._collection[e]=t;else if(Array.isArray(this._collection[e]))this._collection[e].push(t);else{var n=this._collection[e];this._collection[e]=[n,t]}},BunnyFormData.prototype.getAll=function(e){return void 0===this._collection[e]?[]:Array.isArray(this._collection[e])?this._collection[e]:[this._collection[e]]},BunnyFormData.prototype.getAllElements=function(){return this._collection},BunnyFormData.prototype.buildFormDataObject=function(){var e=this,t=new FormData,n=function(n){Array.isArray(e._collection[n])?e._collection[n].forEach(function(e){t.append(n,e)}):t.append(n,e._collection[n])};for(var i in this._collection)n(i);return t},BunnyFormData.prototype.remove=function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];void 0!==n&&Array.isArray(this._collection[e])?!function(){var i=[];t._collection[e].forEach(function(e){e!==n&&i.push(e)}),t._collection[e]=i}():delete this._collection[e]};var Form$1=Form={_collection:{},_mirrorCollection:{},_valueSetFromEvent:!1,init:function(e){var t=document.forms[e];if(void 0===t)throw new Error("Form with ID "+e+" not found in DOM!");if(void 0!==this._collection[e])throw new Error("Form with ID "+e+" already initiated!");this._collection[e]=new BunnyFormData(t),this._attachChangeAndDefaultFileEvent(e),this._attachRadioListChangeEvent(e),this._attachDOMChangeEvent(e)},isInitiated:function(e){return void 0!==this._collection[e]},_attachChangeAndDefaultFileEvent:function(e){var t=this,n=this._collection[e].getInputs();[].forEach.call(n,function(n){if(t.__attachSingleChangeEvent(e,n),t.__observeSingleValueChange(e,n),"file"===n.type&&n.hasAttribute("value")){var i=n.getAttribute("value");""!==i&&t.setFileFromUrl(e,n.name,i)}})},_attachRadioListChangeEvent:function(e){var t=this._collection[e].getRadioLists();for(var n in t){var i=t[n];this.__observeSingleValueChange(e,i)}},__attachSingleChangeEvent:function(e,t){var n=this;t.addEventListener("change",function(i){"file"===t.type&&i.isTrusted?(n._valueSetFromEvent=!0,t.value=t.files[0],n._valueSetFromEvent=!1):n._parseFormControl(e,t,t.value),void 0!==n._mirrorCollection[e]&&n._mirrorCollection[e][t.name]===!0&&n.setMirrors(e,t.name)})},_parseFormControl:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];"TEXTAREA"===t.tagName?t.type="textarea":t instanceof RadioNodeList&&(t.type="radiolist");var i=t.type.toLowerCase();return i=i.charAt(0).toUpperCase()+i.slice(1),i="_parseFormControl"+i,void 0===n&&(i+="Getter"),void 0!==this[i]?this[i](e,t,n):void 0===n?this._parseFormControlDefaultGetter(e,t):void this._parseFormControlDefault(e,t,n)},_parseFormControlDefault:function(e,t,n){this._collection[e].set(t.name,n)},_parseFormControlDefaultGetter:function(e,t){return Object.getOwnPropertyDescriptor(t.constructor.prototype,"value").get.call(t)},_parseFormControlRadiolist:function(e,t,n){for(var i=!1,o=0;o<t.length;o++){var r=t[o];if(r.value===n){this._collection[e].set(r.name,n),i=!0;break}}if(!i)throw new TypeError('Trying to Form.set() on radio with unexisted value="'+n+'"')},_parseFormControlCheckbox:function(e,t,n){var i=this._collection[e];i.setCheckbox(t.name,n,t.checked)},_parseFormControlFile:function(e,t,n){if(!(""===n||n instanceof Blob||n instanceof File))throw new TypeError("Only empty string, Blob or File object is allowed to be assigned to .value property of file input using Bunny Form");void 0===n.name&&(n.name="blob"),this._collection[e].set(t.name,n)},_parseFormControlFileGetter:function(e,t){return this.get(e,t.name)},__observeSingleValueChange:function(e,t){var n=this;Object.defineProperty(t,"value",{get:function(){return n._parseFormControl(e,t)},set:function(i){if("file"!==t.type&&Object.getOwnPropertyDescriptor(t.constructor.prototype,"value").set.call(t,i),n._parseFormControl(e,t,i),!(t instanceof RadioNodeList||this._valueSetFromEvent)){var o=new CustomEvent("change");t.dispatchEvent(o)}}})},_initNewInput:function(e,t){this._checkInit(e),this._collection[e]._initSingleInput(t),this.__attachSingleChangeEvent(e,t),this.__observeSingleValueChange(e,t)},_attachDOMChangeEvent:function(e){var t=this,n=document.forms[e],i={childList:!0,subtree:!0},o=new MutationObserver(function(n){n.forEach(function(n){n.addedNodes.length>0?t.__handleAddedNodes(e,n.addedNodes):n.removedNodes.length>0&&t.__handleRemovedNodes(e,n.removedNodes)})});o.observe(n,i)},__handleAddedNodes:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if("INPUT"===i.tagName)this._initNewInput(e,i);else if(void 0!==i.getElementsByTagName){var o=i.getElementsByTagName("input");if(o.length>0)for(var r=0;r<o.length;r++)this._initNewInput(e,o[r])}}},__handleRemovedNodes:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if("INPUT"===i.tagName){var o=i;this._collection[e].remove(o.name,o.value)}else if(void 0!==i.getElementsByTagName){var r=i.getElementsByTagName("input");if(r.length>0)for(var a=0;a<r.length;a++){var s=r[a];this._collection[e].remove(s.name,s.value)}}}},initAll:function(){var e=this;[].forEach.call(document.forms,function(t){e.init(t.id)})},_checkInit:function(e){if(void 0===this._collection[e])throw new Error("Form with ID "+e+" is not initiated! Init form with Form.init(form_id) first.")},set:function(e,t,n){this._checkInit(e);var i=this._collection[e].getInput(t);i.value=n},get:function(e,t){return this._checkInit(e),this._collection[e].get(t)},getAll:function(e){return this._checkInit(e),this._collection[e].getAllElements()},getFormDataObject:function(e){return this._checkInit(e),this._collection[e].buildFormDataObject()},getInput:function(e,t){return this._collection[e].getInput(t)},append:function(e,t,n){this._checkInit(e);var i=this._collection[e];i.append(t,n)},remove:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];this._checkInit(e),this._collection[e].remove(t,n)},mirror:function(e,t){var n=this;this._checkInit(e);var i=this._collection[e].getInput(t);if(!(i instanceof HTMLInputElement))throw new Error("Cannot mirror radio buttons or checkboxes.");void 0===this._mirrorCollection[e]&&(this._mirrorCollection[e]={}),this._mirrorCollection[e][t]=!0,this.setMirrors(e,t),i.addEventListener("change",function(){n.setMirrors(e,t)})},mirrorAll:function(e){var t=this;this._checkInit(e);var n=this._collection[e].getInputs();[].forEach.call(n,function(n){n instanceof HTMLInputElement&&"checkbox"!==n.type&&"radio"!==n.type&&t.mirror(e,n.name)})},getMirrors:function(e,t){return this._checkInit(e),document.querySelectorAll('[data-mirror="'+e+"."+t+'"]')},setMirrors:function(e,t){var n=this;this._checkInit(e);var i=this.getMirrors(e,t),o=this._collection[e].getInput(t);[].forEach.call(i,function(i){if("IMG"===i.tagName){var r=n.get(e,t);""===r?i.src="":0!==r.size&&(i.src=URL.createObjectURL(n.get(e,t)))}else i.textContent=o.value})},setFileFromUrl:function(e,t,n){var i=this,o=new XMLHttpRequest,r=new Promise(function(n,r){o.onload=function(){if(200===o.status){var a=o.response;i.set(e,t,a),n(a)}else r(o)}});return o.open("GET",n,!0),o.responseType="blob",o.send(),r},submit:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?"POST":arguments[2],i=arguments.length<=3||void 0===arguments[3]?{"X-Requested-With":"XMLHttpRequest"}:arguments[3];this._checkInit(e);var o=new XMLHttpRequest;null===t&&(t=document.forms[e].hasAttribute("action")?document.forms[e].getAttribute("action"):""),o.open(n,t);var r=new Promise(function(e,t){o.onload=function(){200===o.status?e(o.responseText):t(o)}});for(var a in i)o.setRequestHeader(a,i[a]);return this._collection[e].set("categories",[2,3]),o.send(this.getFormDataObject(e)),r}};document.addEventListener("DOMContentLoaded",function(){document.getElementsByTagName("select").forEach(function(e){var t=e.getAttribute("placeholder");if(null!==t){for(var n=!1,i=0;i<e.options.length;i++)if(e.options[i].hasAttribute("selected")){n=!0;break}var o=document.createElement("option");o.setAttribute("value",""),o.textContent=t,e.insertBefore(o,e.firstChild),n||(e.selectedIndex=0),0===e.selectedIndex?e.classList.add("placeholder"):e.classList.remove("placeholder"),e.addEventListener("change",function(){0===e.selectedIndex?e.classList.add("placeholder"):e.classList.remove("placeholder")})}})});var Facebook={init:function(){window.fbAsyncInit=function(){FB.init({appId:Server.env.fbAppId,cookie:!0,xfbml:!0,version:"v2.5"})},function(e,t,n){var i,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk")},login:function(e,t){FB.login(function(n){n.authResponse?FB.api("/me?fields=id,email",function(t){var n={};n.provider="facebook",n.id=t.id,n.email=t.email,e(n)}):t()},{scope:"public_profile"})},getProfileData:function(e,t){FB.login(function(n){n.authResponse?FB.api("/me?fields=id,first_name,last_name,email,gender,locale,birthday",function(t){var n={};n.provider="facebook",n.id=t.id,n.email=t.email,n.first_name=t.first_name,n.last_name=t.last_name,n.gender=t.gender,n.locale=t.locale,n.birthday=t.birthday,e(n)}):t()},{scope:"public_profile,email,user_birthday"})}},Alert=function(){function e(t,n){babelHelpers.classCallCheck(this,e),this.el=document.createElement("div"),this.el.setAttribute("class",e.getClass()),this.el.setAttribute("id",t),this.el.textContent=n,this.id=t}return babelHelpers.createClass(e,[{key:"insert",value:function(){var t=arguments.length<=0||void 0===arguments[0]?null:arguments[0];t=null==t?this.id+"_container":t;var n=document.getElementById(t);if(null==n)throw"Container not found.";var i=e.getExisting(this.id);null!=i?i.textContent=this.el.textContent:n.appendChild(this.el)}}],[{key:"exists",value:function(t){return null==e.getExisting(t)||"undefined"==e.getExisting(t)}},{key:"remove",value:function(t){var n=e.getExisting(t);null!=n&&n.parentNode.removeChild(n)}},{key:"hide",value:function(t){var n=e.getExisting(t);null==n||n.classList.contains("hidden-xs-up")||n.classList.toggle("hidden-xs-up")}},{key:"getExisting",value:function(t){var n=document.querySelector("#"+t+"."+e.getClass());return null==n?null:n}},{key:"getClass",value:function(){return"app-alert"}}]),e}(),Url={getQueryParam:function(e){var t=arguments.length<=1||void 0===arguments[1]?window.location.href:arguments[1],n=new RegExp("[?&]"+e+"=([^&#]*)","i"),i=n.exec(t);return i?i[1]:null}},Radio={create:function(e,t,n){for(var i=document.getElementById(e),o=i.getElementsByClassName(t),r=i.getElementsByTagName("input"),a=null,s=0;s<r.length;s++)if(r[s].checked){a=s;break}null===a&&(a=0),o[a].classList.contains(n)||o[a].classList.add(n);for(var l=function(e){r[e].addEventListener("change",function(){o[a].classList.remove(n),a=e,o[e].classList.add(n)})},c=0;c<r.length;c++)l(c)}},BunnyFile={download:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=new XMLHttpRequest,i=new Promise(function(e,t){n.onload=function(){if(200===n.status){var i=n.response;e(i)}else t(n)}});return n.open("GET",e,!0),t&&(n.responseType="blob"),n.send(),i},base64ToBlob:function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([i],{type:n})},blobToBase64:function(e){var t=new FileReader,n=new Promise(function(e,n){t.onloadend=function(){var n=t.result;e(n)},t.onerror=function(e){n(e)}});return t.readAsDataURL(e),n},getBlobLocalURL:function(e){if(!(e instanceof Blob||e instanceof File))throw new TypeError("Argument in BunnyFile.getBlobLocalURL() is not a Blob or File object");return URL.createObjectURL(e)}},BunnyImage={getImageByURL:function(e){return this._toImagePromise(e)},_toImagePromise:function(e){var t=new Image,n=new Promise(function(e,n){t.onload=function(){e(t)},t.onerror=function(e){n(e)}});return t.crossOrigin="Anonymous",t.src=e,n},getImageByBlob:function(e){var t=BunnyFile.getBlobLocalURL(e);return this._toImagePromise(t)},getImageByBase64:function(e){var t=e;return this._toImagePromise(t)},getImageByCanvas:function(e){var t=e.toDataURL();return this._toImagePromise(t)},imageToCanvas:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];if(!e.complete)throw new Error("Can not create canvas from Image. Image is not loaded yet.");var i=document.createElement("canvas");return null===t&&null===n?(i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0)):(i.width=t,i.height=n,i.getContext("2d").drawImage(e,0,0,t,n)),i},imageToBase64:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return this.imageToCanvas(e,t,n).toDataURL()},imageToBlob:function(e){return BunnyFile.base64ToBlob(this.imageToBase64(e))},getImageURL:function(e){return e.src},getImageWidth:function(e){if(!e.complete)throw new Error("Can not get Image.width. Image is not loaded yet.");return e.width},getImageHeight:function(e){if(!e.complete)throw new Error("Can not get Image.height. Image is not loaded yet.");return e.height},getImageNewAspectSizes:function(e,t,n){var i=this.getImageWidth(e),o=this.getImageHeight(e);if(0===i||0===o)throw new Error("Image width or height is 0 in BunnyImage.getImageNewAspectSizes().");var r=Math.min(t/i,n/o);return{width:Math.floor(i*r),height:Math.floor(o*r)}},resizeImage:function(e,t,n){var i=this.getImageNewAspectSizes(e,t,n),o=i.width,r=i.height,a=this.imageToCanvas(e,o,r);return this.getImageByCanvas(a)}},RegisterStep2PhotoController={resizeSize:500,croppieViewportSize:250,btnsAddPhoto:document.querySelectorAll('[data-id="add_photo"]'),labelsAddPhoto:document.querySelectorAll('[data-id="add_or_change_photo_label"]'),btnRemovePhoto:document.getElementById("remove_photo"),photoInput:document.getElementById("photo"),photoPreview:document.getElementById("photo_preview"),photoPreviewEmpty:document.getElementById("photo_preview_empty"),photoPreviewContainer:document.getElementById("photo_preview_container"),btnPhotoCrop:document.getElementById("photo_crop_btn"),btnPhotoRotate:document.getElementById("photo_rotate_btn"),photoPopup:document.getElementById("photo_popup"),croppie:null,init:function(){""!==Form$1.get(RegisterController.form.id,this.photoInput.name)&&this.removeImageFromForm(),this.attachEventListeners(),Form$1.mirror(RegisterController.form.id,this.photoInput.name)},initFromUrl:function(e){Form$1.setFileFromUrl(RegisterController.form.id,this.photoInput.name,e)},initCroppie:function(e,t){var n=this.resizeSize/this.croppieViewportSize;e=Math.floor(e/n),t=Math.floor(t/n);var i=Math.min(e,t);null!==this.croppie&&this.croppie.destroy(),this.croppie=new Croppie(document.getElementById("photo_preview_container"),{viewport:{width:i,height:i,type:"circle"},boundary:{width:e,height:t},showZoomer:!1,enableOrientation:!0})},attachEventListeners:function(){var e=this;this.btnsAddPhoto.forEach(function(t){t.addEventListener("click",function(){return e.photoInput.click()})}),this.btnRemovePhoto.addEventListener("click",function(){e.removeImageFromForm()}),this.photoInput.addEventListener("change",function(){
""!==e.photoInput.value&&(e.updateImage(e.photoInput.value),e.showPopup())}),document.getElementById("photo_crop_btn").addEventListener("click",function(){e.croppie.result({type:"canvas",size:"viewport",format:"jpeg",quality:.8}).then(function(t){e.setNewImageToForm(t),e.hidePopup()})}),document.getElementById("photo_rotate_btn").addEventListener("click",function(){e.croppie.rotate(90)})},updateCroppieImage:function(e){this.croppie.bind({url:e,orientation:1})},updateImage:function(e){var t=this;BunnyImage.getImageByBlob(e).then(function(e){return BunnyImage.resizeImage(e,t.resizeSize,t.resizeSize)}).then(function(e){t.initCroppie(e.width,e.height),t.updateCroppieImage(e.src)})},setNewImageToForm:function(e){var t=BunnyFile.base64ToBlob(e);Form$1.set(RegisterController.form.id,this.photoInput.name,t),this.hideEmptyPreview(),this.showRemovePhotoBtn(),this.labelsAddPhoto.forEach(function(e){return e.textContent=Server.lang.changePhoto})},removeImageFromForm:function(){Form$1.set(RegisterController.form.id,this.photoInput.name,""),this.showEmptyPreview(),this.hideRemovePhotoBtn(),this.labelsAddPhoto.forEach(function(e){return e.textContent=Server.lang.addPhoto})},showPopup:function(){this.photoPopup.removeAttribute("hidden")},hidePopup:function(){this.photoPopup.setAttribute("hidden","")},showEmptyPreview:function(){this.photoPreviewEmpty.removeAttribute("hidden")},hideEmptyPreview:function(){this.photoPreviewEmpty.setAttribute("hidden","")},showRemovePhotoBtn:function(){this.btnRemovePhoto.removeAttribute("hidden")},hideRemovePhotoBtn:function(){this.btnRemovePhoto.setAttribute("hidden","")}},RegisterStep2ProfileController={nameInput:document.getElementById("name"),socialIdInput:document.getElementById("social_id"),socialProviderInput:document.getElementById("social_provider"),birthDay:document.getElementById("birth_day"),birthMonth:document.getElementById("birth_month"),birthYear:document.getElementById("birth_year"),birthDate:document.getElementById("birth_date"),genderInputName:"gender_sid",locale:document.getElementById("locale"),btn2:document.getElementById("btn_step2"),categoryList:null,options:{geoOption:{nameSelector:"hometown_name",locationSelector:"place_location",idSelector:"place_id",latSelector:"location_lat",lngSelector:"location_lng",countrySelector:"country_name"}},init:function(e){this.changeTexts(),this.putSocialDataToDom(e),this.attachEventHandlers(),GoogleGeo.init(this.options),this.initCustomUIElements(),RegisterStep2PhotoController.init(),RegistrationAutofill$1.fillStep2()},attachEventHandlers:function(){var e=this;this.birthMonth.addEventListener("change",function(){return e.refreshDayList()}),this.birthYear.addEventListener("change",function(){return e.refreshDayList()}),this.btn2.addEventListener("click",function(){return e.handleStep2Completion()})},changeTexts:function(){RegisterController.changeTexts(Server.lang.section2title,Server.lang.section2subtitle)},initCustomUIElements:function(){Checkbox.create("checkbox","app-auth-checkbox","checked"),Radio.create("gender","app-auth-radio","checked")},putSocialDataToDom:function(e){if(void 0!==e.id&&Form$1.set(RegisterController.form.id,this.socialIdInput.name,e.id),void 0!==e.provider&&Form$1.set(RegisterController.form.id,this.socialProviderInput.name,e.provider),void 0!==e.locale&&Form$1.set(RegisterController.form.id,this.locale.name,e.locale),void 0!==e.email&&RegisterController.setEmail(e.email),void 0!==e.first_name&&Form$1.set(RegisterController.form.id,this.nameInput.name,e.first_name),void 0!==e.last_name&&Form$1.set(RegisterController.form.id,this.nameInput.name,e.first_name+" "+e.last_name),void 0!==e.gender&&("male"===e.gender?Form$1.set(RegisterController.form.id,this.genderInputName,"1"):Form$1.set(RegisterController.form.id,this.genderInputName,"2")),void 0!==e.birthday){var t=new Date(e.birthday);this.birthDate.value=DatePicker.getISODateFromDateParts(t.getFullYear(),t.getMonth(),t.getDate()),this.birthDay.value=t.getDate(),this.birthMonth.value=t.getMonth()+1,this.birthYear.value=t.getFullYear(),this.refreshDayList()}void 0!==e.image&&RegisterStep2PhotoController.initFromUrl(e.image)},refreshDayList:function(){var e=CalendarDate.getDaysInMonth(this.birthYear.value,this.birthMonth.value),t=this.birthDay,n=t.value;t.options.length=1;for(var i=1;e>=i;i++){var o=i==n;t.options[t.options.length]=new Option(i,i,!1,o)}},refreshDate:function(){var e=new Date(this.birthYear.value,this.birthMonth.value-1,this.birthDay.value);this.birthDate.value=DatePicker.getISODateFromDateParts(e.getFullYear(),e.getMonth(),e.getDate())},handleStep2Completion:function(){RegisterController.validateStep(2)&&(this.refreshDate(),RegisterController.switchStep(3,{name:this.nameInput.value}))}},MultiSelectionList=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2];babelHelpers.classCallCheck(this,e),this.id=t,this.containerEl=document.getElementById(t),this.attachEventHandlers(),this.onSelectAtLeastOneClb=n,this.onDeselectAllClb=i,this.selectionClassName="selected"}return babelHelpers.createClass(e,[{key:"attachEventHandlers",value:function(){var e=this,t=this.containerEl.getElementsByClassName("list-item");t.forEach(function(t){t.addEventListener("click",function(t){var n=t.target;n.classList.toggle(e.selectionClassName);var i=e.hasClass(n,e.selectionClassName),o=n.getAttribute("data-id"),r=e.containerEl;if(i){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("id",e.getInputId(o)),a.setAttribute("value",o),a.setAttribute("name",e.getContainerId()+"[]"),r.appendChild(a)}else r.removeChild(r.querySelector("#"+e.getInputId(o)));i||r.getElementsByClassName(e.selectionClassName).length>0&&null!=e.onSelectAtLeastOneClb?e.onSelectAtLeastOneClb():e.onDeselectAllClb()})})}},{key:"getInputId",value:function(e){return"id_"+e}},{key:"hasClass",value:function(e,t){var n=" "+t+" ";return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(n)>-1}},{key:"getContainerId",value:function(){return this.containerEl.getAttribute("id")}}]),e}(),RegisterStep3CategoriesController={categoryList:null,name:null,btn3:document.getElementById("btn_step3"),init:function(e){this.name=e.name,this.changeTexts(),this.attachEventHandlers(),this.initMultiSelectionList(),RegistrationAutofill$1.fillStep3()},attachEventHandlers:function(){var e=this;this.btn3.addEventListener("click",function(){return e.handleStep3Completion()})},changeTexts:function(){var e=Server.lang.section3title.replace(":name",this.name);RegisterController.changeTexts(e,Server.lang.section3subtitle)},initMultiSelectionList:function(){var e=this;this.categoryList=new MultiSelectionList("categories_bit",function(){e.btn3.disabled=!1},function(){e.btn3.disabled=!0})},handleStep3Completion:function(){RegisterController.switchStep(4,{name:this.name})}},UserInterests={container:null,searchInput:null,interests:null,loadedInterests:null,addInterestBtn:null,finishBtn:null,loadMoreBtn:null,selectionClassName:"selected",create:function(e){this.container=document.getElementById(e),this.searchInput=this.container.querySelector("#search"),this.interests=this.container.querySelector("#interests"),this.refreshLoadedInterests(),this.activeInterests=this.interests.getElementsByClassName(this.selectionClassName),this.addInterestBtn=this.container.querySelector(".app-search-autocomplete").querySelector("#add_interest"),this.finishBtn=this.container.querySelector("#btn_finish"),this.loadMoreBtn=document.getElementById("load_more_interests"),this.loadInterests(),Autocomplete.create(this.searchInput.getAttribute("id"),null,"/api/v1/interests/?format=keyvalue&fields=name&limit=10&like[name]={search}",this.acHandler),this.attachEventHandlers()},acHandler:function(e){try{e=JSON.parse(e)}catch(t){return[]}return e},attachEventHandlers:function(){var e=this;this.addInterestBtn.addEventListener("click",function(){return e.handleAddBtnClick()}),this.searchInput.addEventListener("click",function(){return e.handleAddBtnClick()}),this.searchInput.addEventListener("keydown",function(t){13==t.keyCode&&e.handleAddBtnClick()}),this.loadMoreBtn.addEventListener("click",function(){return e.loadInterests()})},handleAddBtnClick:function(){var e=this.searchInput.value,t=this.findInLoadedInterests(e);null!=e&&""!=e&&"undefined"!=e&&(null==t?this.addInterestNode(e):this.hasClass(t,this.selectionClassName)||this.toggleInterestBtn(t))},loadInterests:function(){var e=this,t=this,n=this.getLoadedInterestCount();Ajax$1.get("/api/v1/interests/?fields=id,name&limit=20&offset="+n,function(n){var i=JSON.parse(n);if(Array.isArray(i)&&0==i.length)e.loadMoreBtn.className+=" hidden-xs-up";else if("undefined"!=typeof i.data.interests){var o=i.data.interests;o.forEach(function(e){UserInterests.addInterestNode(e.name,e.id)}),t.refreshLoadedInterests()}})},addInterestNode:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],i=this.findInLoadedInterests(e);null==i?""==n?Ajax$1.get("/api/v1/interests/?fields=id,name&limit=1&equalTo[name]="+e,function(n){var i=JSON.parse(n);if(i.data.interests.length>0){var o=i.data.interests;t.createNewInterestNode(o[0].name,o[0].id,!0)}else t.createNewInterestNode(e,"",!0)},function(i){t.createNewInterestNode(e,n,!0)}):this.createNewInterestNode(e,n):this.hasClass(i,this.selectionClassName)||this.toggleInterestBtn(i)},createNewInterestNode:function(e,t){var n=this,i=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.interests.insertAdjacentHTML("beforeend",UserInterests.getInterestHtml(e,t));var o=this.interests.lastChild;o.addEventListener("click",function(e){e.stopPropagation(),n.toggleInterestBtn(o)}),i&&this.toggleInterestBtn(o)},toggleInterestBtn:function(e){e.classList.toggle(this.selectionClassName);var t=this.hasClass(e,this.selectionClassName),n=this;if(t){var i=e.getAttribute("data-interest_id"),o=e.getElementsByClassName("interest-text")[0].innerHTML;""==i||null==i||"udefined"==i?e.insertAdjacentHTML("beforeend",'<input type="hidden" name="new_interest_list[]" value="'+o+'">'):e.insertAdjacentHTML("beforeend",'<input type="hidden" name="interest_list[]" value="'+i+'">')}else{var r=e.querySelector("input");e.removeChild(r)}this.finishBtn.disabled&&t?this.finishBtn.disabled=!1:this.finishBtn.disabled||t||0==this.activeInterests.length&&(this.finishBtn.disabled=!0);var a=n.getSelectedInterestIdList();Autocomplete.get(n.searchInput.getAttribute("id")+"_autocomplete").ajaxUrl="/api/v1/interests/?format=keyvalue&fields=name&limit=10&notIn[id]="+a+"&like[name]={search}"},getInterestHtml:function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return'<div class="app-list-item-faded" data-interest_id="'+t+'">'+('<div class="interest-text">'+e+"</div>")+"</div>"},getSelectedInterestIdList:function(){var e=this,t="",n=this.loadedInterests;return n.forEach(function(n){e.hasClass(n,e.selectionClassName)&&(t+=n.getAttribute("data-interest_id")+",")}),t.replace(/(^,)|(,$)/g,"")},findInLoadedInterests:function(e){var t=this.loadedInterests,n=null;return t.forEach(function(t){t.getElementsByClassName("interest-text")[0].innerHTML==e&&(n=t)}),n},hasClass:function(e,t){var n=" "+t+" ";return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(n)>-1},getLoadedInterestCount:function(){return this.loadedInterests.length},refreshLoadedInterests:function(){this.loadedInterests=this.interests.getElementsByClassName("app-list-item-faded")}},RegisterStep4InterestsController={btnFinish:document.getElementById("btn_finish"),name:null,init:function(e){UserInterests.create("user-intrests"),this.attachEventHandlers(),this.name=e.name,this.changeTexts(),RegistrationAutofill$1.fillStep4()},changeTexts:function(){var e=Server.lang.section4title.replace(":name",this.name);RegisterController.changeTexts(e,Server.lang.section4subtitle)},attachEventHandlers:function(){var e=this;this.btnFinish.addEventListener("click",function(t){return e.handleRegFormSubmit(t)})},handleRegFormSubmit:function(e){var t=this;Spinner.toggle(this.btnFinish),RegisterController.validateStep(4)&&!function(){var n=new XMLHttpRequest;n.open("POST","api/v1/register",!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=function(e){if(200==n.status){var i=JSON.parse(n.responseText);"success"==i.status?redirect(Server.app.webRedirectTo):"registered"==i.status?redirect("/login"):(Spinner.toggle(t.btnFinish),RegisterController.showFormAlert("Registration failed. Please try once more."))}else Spinner.toggle(t.btnFinish),document.open(),document.write(n.responseText),document.close()},n.send(Form$1.getFormDataObject(RegisterController.form.id)),e.preventDefault()}()}},RegistrationAutofill$1=RegistrationAutofill={fillStep1:function(){Url.getQueryParam("test")>=1&&(RegisterStep1Controller.emailInput.value="test_1234@urlaubsgluck.local",RegisterStep1Controller.passwordInput.value="12345678",RegisterStep1Controller.emailBtn.click())},fillStep2:function(){if(Url.getQueryParam("test")>=2){RegisterStep2ProfileController.nameInput.value="John";var e=document.getElementsByName(RegisterStep2ProfileController.options.geoOption.nameSelector)[0];RegisterStep2ProfileController.birthDay.value=1,RegisterStep2ProfileController.birthMonth.value=1,RegisterStep2ProfileController.birthYear.value=1980,simulateAutocompleteSelect(e,"Berlin").then(function(){RegisterStep2ProfileController.btn2.click()})}},fillStep3:function(){Url.getQueryParam("test")>=3&&setTimeout(function(){document.getElementById("categories_bit").firstElementChild.click(),setTimeout(function(){RegisterStep3CategoriesController.btn3.click()},800)},800)},fillStep4:function(){Url.getQueryParam("test")>=4&&setTimeout(function(){var e=document.getElementById("search");simulateAutocompleteSelect(e,"Ta"),setTimeout(function(){},800)},800)}},RegisterStep1Controller={emailAlertId:"email_alert",emailInput:document.getElementById("email"),passwordInput:document.getElementById("password"),fbBtn:document.getElementById("btn_fb"),googleBtn:document.getElementById("btn_google"),emailBtn:document.getElementById("btn_email"),init:function(){Facebook.init(),this.attachEventHandlers(),RegistrationAutofill$1.fillStep1()},test:function(){Form$1.set(RegisterController.form.id,this.emailInput.name,"test.registration@gmail.com"),Form$1.set(RegisterController.form.id,this.passwordInput.name,"12345678"),this.emailBtn.click()},attachEventHandlers:function(){var e=this;this.fbBtn.addEventListener("click",function(){return e.handleStep1Fb()}),this.googleBtn.addEventListener("click",function(){return e.handleStep1Google()}),this.emailBtn.addEventListener("click",function(){return e.handleStep1Email()})},clearEmailAndPassword:function(){Form$1.set(RegisterController.form.id,this.emailInput.name,""),Form$1.set(RegisterController.form.id,this.passwordInput.name,"")},showEmailAlert:function(e){new Alert(this.emailAlertId,e).insert()},handleStep1Fb:function(){var e=this;this.clearEmailAndPassword(),Facebook.getProfileData(function(t){return e.handleFbProfileData(t)},function(){})},handleFbProfileData:function(e){var t=this;this.linkToExistingAccount(e,function(e){t.completeFbStep1(e)})},completeFbStep1:function(e){var t=this;FB.api("/me/picture?redirect=false&width=500&height=500",function(n){e.image=n.data.url,t.completeStep1(e)})},handleGoogleClientLoad:function(){GoogleProfile.handleClientLoad()},handleStep1Google:function(){var e=this;GoogleProfile.login(function(t){return e.handleGoogleLoginResult(t)})},handleGoogleLoginResult:function(e){var t=this;GoogleProfile.getData(e,function(e){return t.handleGoogleProfileData(e)})},handleGoogleProfileData:function(e){var t=this;this.linkToExistingAccount(e,function(e){t.completeStep1(e)})},handleStep1Email:function(){var e=this;RegisterController.validateStep(1)&&this.checkEmail(function(){return e.handleEmailCheckSuccess()},function(){return e.handleEmailCheckFailure()})},checkEmail:function(e,t){Ajax$1.get("/api/v1/users/check-email/"+Form$1.get(RegisterController.form.id,this.emailInput.name),function(n){var i=JSON.parse(n);"success"===i.status?e():t()})},handleEmailCheckSuccess:function(){RegisterController.switchStep(2)},handleEmailCheckFailure:function(){this.showEmailAlert(Server.lang.alertEmailTaken)},linkToExistingAccount:function(e,t){var n=new FormData;n.append("provider",e.provider),n.append("token",e.token);var i=new XMLHttpRequest;i.open("POST","/api/v1/social-login",!0),i.onload=function(n){if(200==i.status){var o=JSON.parse(i.responseText);"success"==o.status?window.location=Server.app.webRedirectTo:t(e)}else t(e)},i.send(n)},completeStep1:function(e){RegisterController.switchStep(2,e)}},Validate=Object.create(BunnyValidate);Validate.lang.required="Required";var RegisterController={hiddenClass:"hidden-xs-up",formAlertId:"form_alert",form:document.getElementById("reg_form"),footer:document.getElementById("auth_footer"),title:document.getElementById("auth_title"),subTitle:document.getElementById("auth_subtitle"),emailInput:document.getElementById("email"),sections:{1:document.getElementById("step1"),2:document.getElementById("step2"),3:document.getElementById("step3"),4:document.getElementById("step4")},controllers:{1:RegisterStep1Controller,2:RegisterStep2ProfileController,3:RegisterStep3CategoriesController,4:RegisterStep4InterestsController},index:function(){Form$1.init(this.form.id),RegisterStep1Controller.init()},switchStep:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.sections[e-1].classList.add(this.hiddenClass),this.sections[e].classList.remove(this.hiddenClass),this.controllers[e].init(t),Element.scrollTo(this.title)},validateStep:function(e){return Validate.validateSection(this.sections[e])},changeTexts:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];this.title.textContent=e,this.subTitle.textContent=t,this.footer.innerHTML=n},showFormAlert:function(e){new Alert(this.formAlertId,e).insert()},setEmail:function(e){Form$1.set(this.form.id,this.emailInput.name,e)}},Validate$1=Object.create(BunnyValidate);Validate$1.lang.required="Required";var LoginController={fbBtn:document.getElementById("btn_fb"),googleBtn:document.getElementById("btn_google"),emailAlertId:"email_alert",socialAlertId:"social_alert",fbName:"Facebook",googleName:"Google",socialLoginFailedMsg:"Failed to login with :provider account.",index:function(){Facebook.init(),Checkbox.create("checkbox","app-auth-checkbox","checked"),this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.fbBtn.addEventListener("click",function(){return e.handleFbLogin()}),this.googleBtn.addEventListener("click",function(){return e.handleGoogleLogin()})},handleFbLogin:function(){var e=this;this.hideAlerts(),Facebook.login(function(t){return e.handleSocialLoginResult(t,e.fbName)},function(){return e.handleFbLoginFailure()})},handleFbLoginFailure:function(){},handleGoogleLogin:function(){var e=this;this.hideAlerts(),GoogleProfile.login(function(t){return GoogleProfile.getData(t,function(t){return e.handleSocialLoginResult(t,e.googleName)})},function(){})},handleSocialLoginResult:function(e,t){var n=this,i=new FormData;i.append("provider",e.provider),e.hasOwnProperty("token")&&i.append("token",e.token);var o=new XMLHttpRequest;o.open("POST","/api/v1/social-login",!0),o.onload=function(){if(t==n.fbName,200==o.status){var e=JSON.parse(o.responseText);"success"==e.status?window.location=Server.app.webRedirectTo:n.showSocialAlert(e.message)}else n.showSocialAlert(n.socialLoginFailedMsg.replace(":provider",t))},o.send(i)},showSocialAlert:function(e){new Alert(this.socialAlertId,e).insert()},hideAlerts:function(){Alert.hide(this.emailAlertId),Alert.remove(this.socialAlertId)}},Api={get:function(e){return new Promise(function(t,n){Ajax$1.get("/"+Server.project.apiPrefix+"/"+e,function(e){t(JSON.parse(e))},function(e){n(JSON.parse(e))})})}},DateSelector={attachEventHandlers:function(){var e=this;this.month.addEventListener("change",function(){return e.refreshDayList()}),this.year.addEventListener("change",function(){return e.refreshDayList()})},create:function(e){return this.elementId=e,this.day=document.querySelector("#"+this.elementId+" .app-day-input"),this.month=document.querySelector("#"+this.elementId+" .app-month-input"),this.year=document.querySelector("#"+this.elementId+" .app-year-input"),this.date=document.querySelector("#"+this.elementId+" .app-date-input"),this.attachEventHandlers(),this},setDate:function(e){e=new Date(e),this.date.value=DatePicker.getISODateFromDateParts(e.getFullYear(),e.getMonth(),e.getDate()),this.day.value=e.getDate(),this.month.value=e.getMonth()+1,this.year.value=e.getFullYear(),this.refreshDayList()},refreshDayList:function(){var e=this.daysInMonth(this.month.value,this.year.value),t=this.day,n=t.value;t.options.length=1;for(var i=1;e>=i;i++){var o=i==n;t.options[t.options.length]=new Option(i,i,!1,o)}this.refreshDate()},refreshDate:function(){var e=new Date(this.year.value,this.month.value-1,this.day.value);this.date.value=DatePicker.getISODateFromDateParts(e.getFullYear(),e.getMonth(),e.getDate())},daysInMonth:function(e,t){if(e=parseInt(e),null==e)return 31;switch(e){case 2:return null==t?29:t%4==0&&t%100||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}},Utils={isEmpty:function(e){return"undefined"==e||null==e||""==e}},SearchAutocomplete={_items:[],create:function(e,t,n,i){var o=arguments.length<=4||void 0===arguments[4]?!0:arguments[4],r=document.getElementById(e),a=r.parentNode;this._items[e]={id:e,resource:t,list:i,query:n,baseUrl:Server.project.apiPrefix+"/"+t,el:r,container:a,btnAdd:a.querySelector(".app-search-add-item"),input:a.querySelector("input"),allowNew:o};var s=this._items[e];return this.addInstanceMethods(s),s.btnAdd.addEventListener("click",function(){return s.handleAddBtnClick(e)}),s.list.setOnChangeCallback(function(){return s.refreshAutocompleteUrl()}),s.addHiddenInput(),Autocomplete.create(e,s.getHiddenInputId(),s.getAutocompleteUrl(e))},addInstanceMethods:function(e){e.addHiddenInput=function(){var t=e.getHiddenInputId();e.hiddenInput=document.createElement("input"),e.hiddenInput.setAttribute("type","hidden"),e.hiddenInput.setAttribute("id",t),e.hiddenInput.setAttribute("value",""),e.container.appendChild(e.hiddenInput)},e.getHiddenInputId=function(){return e.id+"_hidden"},e.getAutocompleteUrl=function(){return e.baseUrl+"/?"+e.query+"&notIn[id]="+e.getExclusionIdList()},e.refreshAutocompleteUrl=function(){Autocomplete.get(e.container.getAttribute("id")).ajaxUrl=e.getAutocompleteUrl()},e.getExclusionIdList=function(){return e.list.getIdsOfAddedItems()},e.getSelectedValue=function(){return e.input.value},e.getSelectedId=function(){return e.hiddenInput.value},e.handleAddBtnClick=function(){var t=e.getSelectedId(),n=e.getSelectedValue();if(!Utils.isEmpty(n))if(Utils.isEmpty(t)){var i=e.resource+"?fields=id,name&limit=1&equalTo[name]="+e.getSelectedValue();Api.get(i).then(function(i){t=i.data[e.resource][0].id,e.addItem(n,t)})["catch"](function(t){e.allowNew&&e.addItem(n)})}else e.addItem(n,t)},e.addItem=function(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1];e.list.addItem(t,n),e.refreshAutocompleteUrl(),e.input.value="",e.hiddenInput.value=""}}},TagList={_items:[],create:function(e){var t=arguments.length<=1||void 0===arguments[1]?function(e,t){}:arguments[1],n=document.getElementById(e),i=n.getElementsByTagName("ul")[0];this._items[e]={id:e,container:n,list:i,listItems:i.getElementsByTagName("li"),onChange:function(){},onRemoveItem:function(e,n){return t(e,n)}};var o=this._items[e];return this.addInstanceMethods(o),o.attachEventHandlers(),o},addInstanceMethods:function(e){e.handleTagClick=function(t){t.stopPropagation();var n=t.target,i=n.getAttribute("data-id"),o=null;o=""==i||null==i||"undefined"==i?n.textContent:i;var r=document.querySelector("#"+e.id+' input[type=hidden][value="'+o+'"]');e.onRemoveItem(n.textContent,i),e.container.removeChild(r),e.list.removeChild(n),e.onChange()},e.attachEventHandlers=function(){e.listItems.forEach(function(t){t.addEventListener("click",function(t){return e.handleTagClick(t)})})},e.addItem=function(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1];e.isSelected(t)||(e.addTag(t,n),e.addHiddenInput(t,n),e.onChange())},e.addTag=function(t,n){var i=document.createElement("li");i.setAttribute("class","app-tag app-s-close"),i.setAttribute("data-id",null==n?"":n),i.textContent=t,e.list.appendChild(i),i.addEventListener("click",function(t){return e.handleTagClick(t)})},e.addHiddenInput=function(t,n){var i=document.createElement("input");i.setAttribute("type","hidden"),Utils.isEmpty(n)?(i.setAttribute("name",e.getHiddenInputNameNew()),i.value=t):(i.setAttribute("name",e.getHiddenInputName()),i.value=n),e.container.appendChild(i)},e.getHiddenInputName=function(){return e.id+"[]"},e.getHiddenInputNameNew=function(){return"new_"+e.getHiddenInputName()},e.isSelected=function(t){var n=!1;return e.listItems.forEach(function(e){e.textContent==t&&(n=!0)}),n},e.getIdsOfAddedItems=function(){var t=document.getElementsByName(e.getHiddenInputName()),n="";return t.forEach(function(e){n+=e.value+","}),n.replace(/,+$/,"")},e.setOnChangeCallback=function(t){e.onChange=t}}},_SettingsController,Validate$2=Object.create(BunnyValidate);Validate$2.lang.required="Required";var SettingsController=(_SettingsController={btnSave:document.getElementById("btn_save"),btnCancel:document.getElementById("btn_cancel"),btnDisconnectFb:document.getElementById("btn_disconnect_fb"),btnDisconnectGoogle:document.getElementById("btn_disconnect_google"),imgProfilePhoto:document.getElementById("profile_photo"),inpPhotoFile:document.getElementById("photo_file_inp"),removePhoto:document.getElementById("remove_photo"),inpEmail:document.getElementById("email"),categoryDropDown:document.getElementById("category-names"),form:document.getElementById("edit_profile_form"),geo:GoogleGeo,geoOption:{nameSelector:"hometown_name",locationSelector:"hometown_location",idSelector:"hometown_id",latSelector:"hometown_lat",lngSelector:"hometown_lng"},searchInterests:document.getElementById("search_interests"),searchLanguages:document.getElementById("search_languages"),postData:new FormData(this.form),imageBlob:null,alertDisconnectSocial:document.getElementById("alert_disconnect_social"),btnDisconnSocialCloseAlert:document.getElementById("alert_disconnect_social_close"),alertDisconnectSocialText:document.getElementById("alert_disconnect_social_text"),msgSetPassword:"Cannot disconnect until a password set.",msgSetEmail:"Cannot disconnect until an email set.",hiddenCalss:"hidden-xs-up",init:function(){var e=this;this.geo.resolveLocationData(this.geoOption),this.geo.init(this,this.geoOption.nameSelector),this.interestList=TagList.create("interest_list"),this.categoryList=TagList.create("categories_bit",function(t,n){return e.handleRemoveCategory(t,n)}),this.languageList=TagList.create("language_list"),this.interestSearch=SearchAutocomplete.create(this.searchInterests.getAttribute("id"),"interests","format=keyvalue&fields=name&limit=10&like[name]={search}",this.interestList),this.languageSearch=SearchAutocomplete.create(this.searchLanguages.getAttribute("id"),"languages","format=keyvalue&fields=name&limit=10&like[name]={search}",this.languageList,!1),DateSelector.create("birth_date"),Validate$2.validate(this.form),this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnSave.addEventListener("click",function(t){return e.handleSaveBtnClick(t)}),this.btnCancel.addEventListener("click",function(){return e.handleCancelBtnClick()}),this.categoryDropDown.addEventListener("change",function(){return e.handleCategoryDropdownChange()}),this.imgProfilePhoto.addEventListener("click",function(){return e.inpPhotoFile.click()}),this.removePhoto.addEventListener("click",function(){return e.handleRemovePhoto()}),FileUpload.attachImagePreviewEvent(this.imgProfilePhoto,this.inpPhotoFile),(this.btnDisconnectFb||this.btnDisconnectGoogle)&&this.btnDisconnSocialCloseAlert.addEventListener("click",function(t){return e.handleDisconnSocialCloseAlert(t)}),this.btnDisconnectFb&&this.btnDisconnectFb.addEventListener("click",function(){return e.handleDisconnectFbButtonClick()}),this.btnDisconnectGoogle&&this.btnDisconnectGoogle.addEventListener("click",function(){return e.handleDisconnectGoogleButtonClick()})},handleDisconnSocialCloseAlert:function(){this.alertDisconnectSocial.classList.add(this.hiddenCalss),this.alertDisconnectSocialText.textContent=""},handleRemovePhoto:function(){this.inpPhotoFile.value="",this.imgProfilePhoto.src=Server.project.noAvatarImagePath},handleRemoveCategory:function(e,t){var n=document.createElement("option");n.text=e,n.value=t,this.categoryDropDown.appendChild(n)},handleCategoryDropdownChange:function(e){var t=this.categoryDropDown,n=t.options[t.selectedIndex],i=n.textContent,o=n.value;""!=o&&(this.categoryList.addItem(i,o),t.remove(t.selectedIndex))},handleSaveBtnClick:function(e){var t=this;e.preventDefault(),Validate$2.validateSection(this.form)&&!function(){t.postData=FileUpload.addToForm(t.form,t.inpPhotoFile,t.inpPhotoFile.files[0]);var e=new XMLHttpRequest;e.open("POST","api/v1/edit-profile",!0),e.onload=function(n){if(Spinner.toggle(t.btnSave),200==e.status){var i=JSON.parse(e.responseText);"success"==i.status&&(window.location="/edit-profile")}},Spinner.toggle(t.btnSave),e.send(t.postData)}()},handleCancelBtnClick:function(){window.location="/edit-profile"},handleDisconnectFbButtonClick:function(){this.toggleButton(this.btnDisconnectFb)},handleDisconnectGoogleButtonClick:function(){this.toggleButton(this.btnDisconnectGoogle)}},babelHelpers.defineProperty(_SettingsController,"handleRemovePhoto",function(){this.inpPhotoFile.value="",this.imgProfilePhoto.src=Server.project.noAvatarImagePath}),babelHelpers.defineProperty(_SettingsController,"handleRemoveCategory",function(e,t){var n=document.createElement("option");n.text=e,n.value=t,this.categoryDropDown.appendChild(n)}),babelHelpers.defineProperty(_SettingsController,"toggleButton",function(e){var t=this;""==this.inpEmail.value||null==this.inpEmail.value||"undefined"==this.inpEmail.value?(this.alertDisconnectSocialText.textContent=this.msgSetEmail,this.alertDisconnectSocial.classList.remove(this.hiddenCalss)):!function(){Api.get("profile/is-password-empty").then(function(n){if("success"==n.status)if(1==n.data)t.alertDisconnectSocialText.textContent=t.msgSetPassword,t.alertDisconnectSocial.classList.remove(t.hiddenCalss);else{var i=e.parentNode.parentNode.getElementsByTagName("input")[0];i.value=0==i.value?1:0,e.classList.contains("app-btn-outline-apply")?(e.classList.remove("app-btn-outline-apply"),e.classList.add("app-btn-apply")):(e.classList.remove("app-btn-apply"),e.classList.add("app-btn-outline-apply")),e.blur()}})["catch"](function(e){})}()}),_SettingsController),Validate$3=Object.create(BunnyValidate);Validate$3.lang.required="Required";var ChangePasswordController={btnChangePassword:document.getElementById("btn_change_password"),form:document.getElementById("change_password_form"),inpCurrPassword:document.getElementById("old_password"),inpNewPassword:document.getElementById("password"),inpConfirmPassword:document.getElementById("password_confirmation"),changePwdSuccess:document.getElementById("change_pwd_success"),alertId:"alert",hiddenClass:"hidden-xs-up",msgPasswordNotMatch:"The password confirmation does not match.",init:function(){this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnChangePassword.addEventListener("click",function(t){return e.handleChangePassword(t)})},handleChangePassword:function(e){var t=this;this.hideAllMessages(),Validate$3.validateSection(this.form)&&(this.validatePasswordMatching()?!function(){e.preventDefault(),Spinner.toggle(t.btnChangePassword);
var n=new XMLHttpRequest;n.open("POST","api/v1/change-password",!0),n.onload=function(e){if(200==n.status){Spinner.toggle(t.btnChangePassword);var i=JSON.parse(n.responseText);"success"==i.status?(t.showSuccessMsg(),t.hideSubmitButton()):new Alert(t.alertId,i.data).insert()}},n.send(new FormData(t.form))}():new Alert(this.alertId,this.msgPasswordNotMatch).insert())},hideAllMessages:function(){Alert.remove(this.alertId),this.changePwdSuccess.classList.contains(this.hiddenClass)||this.changePwdSuccess.classList.add(this.hiddenClass)},showSuccessMsg:function(){this.changePwdSuccess.classList.remove(this.hiddenClass)},hideSubmitButton:function(){this.btnChangePassword.classList.contains(this.hiddenClass)||this.btnChangePassword.classList.add(this.hiddenClass)},validatePasswordMatching:function(){return this.inpNewPassword.value!=this.inpConfirmPassword.value?(this.inpConfirmPassword.setCustomValidity("Passwords Don't Match"),!1):(this.inpConfirmPassword.setCustomValidity(""),!0)}},Validate$4=Object.create(BunnyValidate);Validate$4.lang.required="Required";var DeactivateAccountController={linkDeactivate:document.getElementById("deactivate"),form:document.getElementById("deactivate_form"),alertSuccess:document.getElementById("success_alert"),alertError:document.getElementById("deactivation_error_alert"),hiddenClass:"hidden-xs-up",init:function(){this.attachEventHandlers()},attachEventHandlers:function(){var e=this;null!=this.linkDeactivate&&this.linkDeactivate.addEventListener("click",function(t){return e.handleDeactivateClick(t)})},handleDeactivateClick:function(e){var t=this;e.preventDefault(),this.hideAllMessages(),Validate$4.validateSection(this.form)&&!function(){var e=new XMLHttpRequest;e.open("POST","api/v1/deactivate-account",!0),e.onload=function(n){if(200==e.status){var i=JSON.parse(e.responseText);"success"==i.status?t.showSuccessMsg():t.showErrorMsg(i.data)}else t.showErrorMsg("Deactivation failed.")},e.send(new FormData(t.form))}()},hideAllMessages:function(){this.alertError.classList.contains(this.hiddenClass)||this.alertError.classList.add(this.hiddenClass),this.alertSuccess.classList.contains(this.hiddenClass)||this.alertSuccess.classList.add(this.hiddenClass)},showSuccessMsg:function(){this.alertSuccess.classList.remove(this.hiddenClass)},showErrorMsg:function(e){this.alertError.textContent=e,this.alertError.classList.remove(this.hiddenClass)}},NotificationsController={form:document.getElementById("profile_notifications_form"),btnSave:document.getElementById("btn_save_notifications"),btnCancel:document.getElementById("btn_cancel_notifications"),hiddenClass:"hidden-xs-up",init:function(){this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnSave.addEventListener("click",function(t){return e.handleSaveClick(t)}),this.btnCancel.addEventListener("click",function(t){return e.handleCancelClick(t)})},handleCheckBoxClick:function(e){},handleSaveClick:function(e){var t=this;Spinner.toggle(this.btnSave);var n=new XMLHttpRequest;n.open("POST","api/v1/profile-notifications",!0),n.onload=function(e){if(200==n.status){Spinner.toggle(t.btnSave);var i=JSON.parse(n.responseText);"success"==i.status}},n.send(new FormData(this.form))},handleCancelClick:function(e){window.location="/edit-profile"}},BlockedUsersController={formsUnblockUser:document.getElementsByClassName("unblock-user-form"),init:function(){this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.formsUnblockUser.forEach(function(t){t.addEventListener("submit",function(t){return e.handleUnblockSubmit(t)}),Form.init(t.getAttribute("id"))})},handleUnblockSubmit:function(e){var t=e.target;e.preventDefault();var n=new XMLHttpRequest;n.open("POST","api/v1/profile/unblock-user",!0),n.onload=function(e){if(200==n.status){var i=JSON.parse(n.responseText);if("success"==i.status){var o=t.parentNode;o.removeChild(t)}}};var i=e.target.getAttribute("id");n.send(Form.getFormDataObject(i))}},ProfileController={hiddenClass:"hidden-xs-up",activeClass:"active",sections:document.getElementsByClassName("app-profile-section"),sectionSettings:document.getElementById("profile_settings"),sectionNotifications:document.getElementById("notifications"),sectionPassword:document.getElementById("change_password"),sectionDeactivate:document.getElementById("deactivate_account"),sectionBlockedUsers:document.getElementById("blocked_users"),subNavBar:document.querySelector(".app-subnavbar"),navItems:document.querySelectorAll(".app-subnavbar li"),navSettings:document.getElementById("nav_settings"),navNotifications:document.getElementById("nav_notifications"),navBlockedUsers:document.getElementById("nav_blocked_users"),navChangePassword:document.getElementById("change_password"),navDeactivateAccount:document.getElementById("deactivate_account"),edit:function(){SettingsController.init(),ChangePasswordController.init(),DeactivateAccountController.init(),NotificationsController.init(),BlockedUsersController.init(),this.attachEventHandlers(),Checkbox.create("checkbox","app-checkbox","checked")},attachEventHandlers:function(){var e=this;this.navSettings.addEventListener("click",function(){return e.handleNavSettingsClick()}),this.navChangePassword.addEventListener("click",function(){return e.handleNavChangePasswordClick()}),this.navDeactivateAccount.addEventListener("click",function(){return e.handleNavDeactivateClick()}),this.navNotifications.addEventListener("click",function(){return e.handleNavNotificationsClick()}),this.navBlockedUsers.addEventListener("click",function(){return e.handleNavBlockedUsersClick()})},handleNavChangePasswordClick:function(){this.activateSection(this.sectionPassword.getAttribute("id")),this.navDeselectAll()},handleNavDeactivateClick:function(){this.activateSection(this.sectionDeactivate.getAttribute("id")),this.navDeselectAll()},handleNavSettingsClick:function(){this.activateSection(this.sectionSettings.getAttribute("id")),this.activateNavItem(this.navSettings.getAttribute("id"))},handleNavNotificationsClick:function(){this.activateSection(this.sectionNotifications.getAttribute("id")),this.activateNavItem(this.navNotifications.getAttribute("id"))},handleNavBlockedUsersClick:function(){this.activateSection(this.sectionBlockedUsers.getAttribute("id")),this.activateNavItem(this.navBlockedUsers.getAttribute("id"))},navDeselectAll:function(){var e=this;this.navItems.forEach(function(t){t.classList.remove("active"),t.getElementsByClassName("nav-link")[0].classList.remove(e.activeClass)})},activateSection:function(e){var t=this;this.sections.forEach(function(n){n.getAttribute("id")==e?n.classList.remove(t.hiddenClass):n.classList.contains(t.hiddenClass)||n.classList.add(t.hiddenClass)})},activateNavItem:function(e){var t=this;this.navItems.forEach(function(n){n.getAttribute("id")!=e||n.classList.contains(t.activeClass)?(n.classList.remove(t.activeClass),n.getElementsByClassName("nav-link")[0].classList.remove(t.activeClass)):(n.classList.add(t.activeClass),n.getElementsByClassName("nav-link")[0].classList.add(t.activeClass))})}},ActivitiesController$1={hiddenClass:"hidden-xs-up",activeClass:"active",activitiesRows:document.getElementById("activities_rows"),activitiesMoreBlock:document.getElementById("activities_more_block"),btnMore:document.getElementById("app_button_more"),activitiesPage:1,init:function(e){this.userId=e.userId,this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnMore.addEventListener("click",function(){return e.handleBtnMoreClick()})},handleBtnMoreClick:function(){var e=this;Spinner.add(this.btnMore);var t=++this.activitiesPage;Ajax$1.get("/users/"+this.userId+"/activities?page="+t,function(t){Spinner.remove(e.btnMore);var n=JSON.parse(t);e.activitiesRows.insertAdjacentHTML("beforeend",n.html),1==n.showMore?e.unhideElement(e.activitiesMoreBlock):e.hideElement(e.activitiesMoreBlock)},function(t){Spinner.remove(e.btnMore)})},hideElement:function(e){e.classList.contains(this.hiddenClass)||e.classList.add(this.hiddenClass)},unhideElement:function(e){e.classList.remove(this.hiddenClass)}},ReviewsController$1={hiddenClass:"hidden-xs-up",activeClass:"active",reviewsRows:document.getElementById("reviews_rows"),reviewsMoreBlock:document.getElementById("reviews_more_block"),btnMore:document.getElementById("reviews_button_more"),reviewsPage:1,init:function(e){this.userId=e.userId,this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnMore.addEventListener("click",function(){return e.handleBtnMoreClick()})},handleBtnMoreClick:function(){var e=this;Spinner.add(this.btnMore);var t=++this.reviewsPage;Ajax$1.get("/users/"+this.userId+"/reviews?page="+t,function(t){Spinner.remove(e.btnMore);var n=JSON.parse(t);e.reviewsRows.insertAdjacentHTML("beforeend",n.html),1==n.showMore?e.unhideElement(e.reviewsMoreBlock):e.hideElement(e.reviewsMoreBlock)},function(t){Spinner.remove(e.btnMore)})},hideElement:function(e){e.classList.contains(this.hiddenClass)||e.classList.add(this.hiddenClass)},unhideElement:function(e){e.classList.remove(this.hiddenClass)}},FriendsController={hiddenClass:"hidden-xs-up",activeClass:"active",rows:document.getElementById("friends_rows"),moreBlock:document.getElementById("friends_more_block"),btnMore:document.getElementById("friends_button_more"),page:1,init:function(e){this.userId=e.userId,this.attachEventHandlers()},attachEventHandlers:function(){var e=this;this.btnMore.addEventListener("click",function(){return e.handleBtnMoreClick()})},handleBtnMoreClick:function(){var e=this;Spinner.add(this.btnMore);var t=++this.page;Ajax$1.get("/users/"+this.userId+"/friends?page="+t,function(t){Spinner.remove(e.btnMore);var n=JSON.parse(t);e.rows.insertAdjacentHTML("beforeend",n.html),1==n.showMore?e.unhideElement(e.moreBlock):e.hideElement(e.moreBlock)},function(t){Spinner.remove(e.btnMore)})},hideElement:function(e){e.classList.contains(this.hiddenClass)||e.classList.add(this.hiddenClass)},unhideElement:function(e){e.classList.remove(this.hiddenClass)}},PeopleController={btnMore:document.getElementById("btn_more"),url:"/people",sections:document.getElementsByClassName("app-people-section"),sectionNew:document.getElementById("people_new"),sectionPopular:document.getElementById("people_popular"),sectionFriends:document.getElementById("people_friends"),subNavBar:document.querySelector(".app-subnavbar"),navItems:document.querySelectorAll("#nav_items li"),navNew:document.getElementById("nav_new"),navPopular:document.getElementById("nav_popular"),navFriends:document.getElementById("nav_friends"),sectionMoreNew:document.getElementById("show_more_new"),sectionMorePopular:document.getElementById("show_more_popular"),sectionMoreFriends:document.getElementById("show_more_friends"),pageNew:2,pagePopular:1,pageFriends:1,hiddenClass:"hidden-xs-up",appDropdownClass:"app-dropdown",activeClass:"active",txtRetrieving:"Retrieving data...",txtBtnShowMorecaption:"Show more",index:function(){this.currentTabId=document.getElementById("tab").value,Checkbox.create("app-checkbox-label","app-checkbox","checked"),this.attachEventHandlers(),this.initDropdown()},attachEventHandlers:function(){var e=this;this.navNew.addEventListener("click",function(){return e.handleNavNewClick()}),this.navPopular.addEventListener("click",function(){return e.handleNavPopularClick()}),this.navFriends.addEventListener("click",function(){return e.handleNavFriendsClick()}),this.btnMore.addEventListener("click",function(){return e.handleBtnMoreClick()})},initDropdown:function(){var e=document.getElementsByClassName(this.appDropdownClass);e.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation()})})},hideShowMoreBtn:function(){this.btnMore.classList.contains(this.hiddenClass)||this.btnMore.classList.add(this.hiddenClass)},navDeselectAll:function(){var e=this;this.navItems.forEach(function(t){t.classList.remove("active"),t.getElementsByClassName("nav-link")[0].classList.remove(e.activeClass)})},activateSection:function(e){var t=this;this.sections.forEach(function(n){n.getAttribute("id")==e?n.classList.remove(t.hiddenClass):n.classList.contains(t.hiddenClass)||n.classList.add(t.hiddenClass)}),this.currentTabId=e,""==this.getCurrMoreBlock().innerHTML&&(this.hideShowMoreBtn(),this.showMoreRecords())},activateNavItem:function(e){var t=this;this.navItems.forEach(function(n){n.getAttribute("id")!=e||n.classList.contains(t.activeClass)?(n.classList.remove(t.activeClass),n.getElementsByClassName("nav-link")[0].classList.remove(t.activeClass)):(n.classList.add(t.activeClass),n.getElementsByClassName("nav-link")[0].classList.add(t.activeClass))})},handleBtnMoreClick:function(){Spinner.add(this.btnMore),this.showMoreRecords()},showMoreRecords:function(){var e=this,t=this.url+"?page="+this.getPage()+"&tab="+this.currentTabId+this.getCategoryFilter();Ajax$1.get(t,function(t){return e.handleRecevedUsers(t)},function(t){return e.handleUserRetrievalFailure(t)})},getPage:function(){return this.currentTabId==this.sectionNew.getAttribute("id")?this.pageNew:this.currentTabId==this.sectionPopular.getAttribute("id")?this.pagePopular:this.pageFriends},getCurrMoreBlock:function(){return this.currentTabId==this.sectionNew.getAttribute("id")?this.sectionMoreNew:this.currentTabId==this.sectionPopular.getAttribute("id")?this.sectionMorePopular:this.sectionMoreFriends},incrementPage:function(){return this.currentTabId==this.sectionNew.getAttribute("id")?this.pageNew++:this.currentTabId==this.sectionPopular.getAttribute("id")?this.pagePopular++:this.pageFriends++},getCategoryFilter:function(){var e=document.querySelectorAll("[name^=categories][checked]"),t="";return e.forEach(function(e){t+="&"+e.name+"=1"}),t},handleRecevedUsers:function(e){var t=JSON.parse(e);if(1==t.success){this.getPage()>=t.lastPage&&this.btnMore.classList.add(this.hiddenClass);var n=document.createElement("div");n.classList.add("row"),n.innerHTML=t.html,this.getCurrMoreBlock().appendChild(n),Spinner.remove(this.btnMore),this.incrementPage()}this.btnMore.classList.remove(this.hiddenClass)},handleUserRetrievalFailure:function(e){Spinner.remove(this.btnMore)},handleNavNewClick:function(){this.activateSection(this.sectionNew.getAttribute("id")),this.activateNavItem(this.navNew.getAttribute("id"))},handleNavPopularClick:function(){this.activateSection(this.sectionPopular.getAttribute("id")),this.activateNavItem(this.navPopular.getAttribute("id"))},handleNavFriendsClick:function(){this.activateSection(this.sectionFriends.getAttribute("id")),this.activateNavItem(this.navFriends.getAttribute("id"))}};Route.get("/activities",function(){return ActivitiesController.activities()}),Route.get("/activities/create",function(){return ActivitiesController.showAdd()}),Route.get("/activities/{activity}",ActivitiesController,"activity"),Route.get("/reviews",function(){return ReviewsController.reviews()}),Route.get("/reviews/create",function(){return ReviewsController.showAdd()}),Route.get("/reviews/{review}",function(){return ReviewsController.review()}),Route.get("/login",function(){return LoginController.index()}),Route.get("/register",function(){return RegisterController.index()}),Route.get("/users/{userId}/activities",function(e){return ActivitiesController$1.init(e)}),Route.get("/users/{userId}/reviews",function(e){return ReviewsController$1.init(e)}),Route.get("/users/{userId}/friends",function(e){return FriendsController.init(e)}),Route.get("/edit-profile",function(){return ProfileController.edit()}),Route.get("/people",function(){return PeopleController.index()}),document.addEventListener("DOMContentLoaded",function(){Navbar.init()});var CustomSelect$1=CustomSelect={create:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],i={};i.container=e,i.name=t,i.multiple=n,i.toggle=this._getCustomToggleInput(i),i.toggleDefaultLabel=i.toggle.textContent,i.dropdown=this._getDropdown(i),i.hiddenInputContainer=this._createHiddenInputContainer(),this._insertHiddenInputContainer(i,i.hiddenInputContainer),i.hiddenInputs={},i.selectedValues=[];var o=this._getDropdownItems(i);i.dropdownItems={};for(var r=0;r<o.length;r++){var a=o[r];i.dropdownItems[a.dataset.value]=a,this._attachDropdownItemClickEvent(i,a),void 0!==a.dataset.selected&&this._select(i,a.dataset.value,!1)}return i},getOption:function(e,t){return e.dropdownItems[t]},hideOption:function(e,t){this.getOption(e,t).setAttribute("hidden","")},showOption:function(e,t){this.getOption(e,t).removeAttribute("hidden")},select:function(e,t){this.isSelected(e,t)?this.deselect(e,t):this.isMultiple(e)?this._select(e,t):(0!==e.selectedValues.length&&this._deselect(e,e.selectedValues[0],!1),this._select(e,t))},_select:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];e.selectedValues.push(t);var i=this.getOption(e,t);i.classList.add("active"),i.dataset.selected="";var o=this._createHiddenInput(e.name,t);this._insertHiddenInput(e,o),e.hiddenInputs[t]=o,this.isMultiple(e)||this.setLabelByValue(e,t),n&&this._fireChangeEventOnSelect(e,t,i.textContent,!0)},deselect:function(e,t){this.isSelected(e,t)&&this._deselect(e,t)},_deselect:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],i=e.selectedValues.indexOf(t);e.selectedValues.splice(i,1);var o=this.getOption(e,t);o.classList.remove("active"),delete o.dataset.selected,this.isMultiple(e)||0!==e.selectedValues.length||this.setDefaultLabel(e),this._removeHiddenInput(e,t),n&&this._fireChangeEventOnSelect(e,t,o.textContent,!1)},isSelected:function(e,t){return-1!==e.selectedValues.indexOf(t)},isMultiple:function(e){return e.multiple},getSelectedOptions:function(e){for(var t=this.getSelectedValues(e),n={},i=0;i<t.length;i++){var o=t[i];n[o]=e.dropdownItems[o]}return n},getSelectedValues:function(e){return e.selectedValues},getOptionLabel:function(e,t){var n=this.getOption(e,t);return n.textContent},setLabel:function(e,t){e.toggle.textContent=t,this._setToggleActive(e)},setLabelByValue:function(e,t){var n=this.getOptionLabel(e,t);this.setLabel(e,n)},setDefaultLabel:function(e){this.setLabel(e,e.toggleDefaultLabel),this._setToggleInactive(e)},_attachDropdownItemClickEvent:function(e,t){var n=this;t.addEventListener("click",function(){var i=t.dataset.value;n.select(e,i)})},_fireChangeEventOnSelect:function(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],o=new CustomEvent("change",{detail:{value:t,label:n,selected:i}});e.container.dispatchEvent(o)},_getCustomToggleInput:function(e){var t=e.container.getElementsByClassName("dropdown-toggle")[0];if(void 0===t)throw new Error('CustomSelect must have a child element with class="dropdown-toggle"');return t},_getDropdown:function(e){var t=e.container.getElementsByClassName("dropdown-menu")[0];if(void 0===t)throw new Error('CustomSelect must have a child element with class="dropdown-menu"');return t},_getDropdownItems:function(e){var t=e.dropdown.getElementsByClassName("dropdown-item");if(0===t.length)throw new Error('Dropdown in CustomSelect must have at least one child element with class="dropdown-item"');for(var n=0;n<t.length;n++){var i=t[n];if(void 0===i.dataset.value)throw new Error("All Dropdown Items in CustomSelect must have data-value attribute")}return t},_setToggleActive:function(e){e.toggle.classList.add("dropdown-active")},_setToggleInactive:function(e){e.toggle.classList.remove("dropdown-active")},_createHiddenInputContainer:function(){var e=document.createElement("div");return e.setAttribute("hidden",""),e},_insertHiddenInputContainer:function(e,t){e.container.appendChild(t)},_createHiddenInput:function(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n},_getHiddenInputs:function(e){return e.hiddenInputContainer.getElementsByTagName("input")},_getHiddenInputByValue:function(e,t){return e.hiddenInputs[t]},_insertHiddenInput:function(e,t){e.hiddenInputContainer.appendChild(t)},_removeHiddenInput:function(e,t){var n=this._getHiddenInputByValue(e,t);e.hiddenInputContainer.removeChild(n)}},Tag$1=Tag={tagName:"span",className:"app-tag",closeClassName:"app-s-close",create:function(e,t){var n=document.createElement(this.tagName);return n.classList.add(this.className),n.dataset.value=e,n.textContent=t,n},remove:function(e){e.parentNode.removeChild(e),e=void 0},removeByValueIfExists:function(e,t){var n=this.getTagByValue(e,t);n!==!1&&this.remove(n)},getValue:function(e){return e.dataset.value},makeClosable:function(e){var t=this,n=new Promise(function(n){t.addCloser(e),t.attachCloseEvent(e).then(function(i){t.remove(e),n(i)})});return n},getTagsInContainer:function(e){return e.getElementsByClassName(this.className)},getTagByValue:function(e,t){for(var n=this.getTagsInContainer(e),i=0;i<n.length;i++){var o=n[i];if(o.dataset.value===t)return o}return!1},createCloser:function(){var e=document.createElement("span");return e.classList.add(this.closeClassName),e},addCloser:function(e){var t=this.createCloser();e.appendChild(t)},isClosable:function(e){var t=this.getCloser(e);return void 0!==t},getCloser:function(e){return e.getElementsByClassName(this.className)[0]},removeCloser:function(e){if(this.isClosable(e)){var t=this.getCloser(e);e.removeChild(t)}},attachCloseEvent:function(e){var t=this,n=new Promise(function(n,i){e.addEventListener("click",function(){n(t.getValue(e))})});return n}},TagSelector$1=TagSelector={create:function(e,t){var n={};return n.container=e,n.name=t,n.customSelect=CustomSelect$1.create(n.container,t+"[]",!0),n.tagContainer=this._createTagContainer(),this._insertTagContainer(n,n.tagContainer),this._initSelectedTags(n),this._attachChangeEvent(n),n},_addTag:function(e,t,n){var i=Tag$1.create(t,n);Tag$1.makeClosable(i).then(function(t){CustomSelect$1.deselect(e.customSelect,t)}),this._insertTag(e,i)},_attachChangeEvent:function(e){var t=this;e.container.addEventListener("change",function(n){n.detail.selected?t._addTag(e,n.detail.value,n.detail.label):Tag$1.removeByValueIfExists(e.tagContainer,n.detail.value)})},_initSelectedTags:function(e){for(var t=CustomSelect$1.getSelectedValues(e.customSelect),n=0;n<t.length;n++){var i=t[n];this._addTag(e,i,CustomSelect$1.getOptionLabel(e.customSelect,i))}},_insertTag:function(e,t){e.tagContainer.appendChild(t)},_createTagContainer:function(){var e=document.createElement("div");return e},_insertTagContainer:function(e,t){e.container.parentNode.insertBefore(t,e.container.nextSibling)}};Filter.prototype.getForm=function(){return this._form},Filter.prototype.getCustomInput=function(e){return document.forms[this._formId].querySelector('[data-form-input="'+e+'"]')},Filter.prototype.getSearchInput=function(){return this._searchInput},Filter.prototype.getCategoriesCustomInput=function(){return this._categoriesCustomInput},Filter.prototype.getDateCustomInput=function(){return this._dateCustomInput},Filter.prototype.initCategoriesCustomInput=function(){var e=this.getCategoriesCustomInput();null!==this.getCategoriesCustomInput()&&TagSelector$1.create(e,this._categoriesName)},Filter.prototype.initDateCustomInput=function(){var e=this.getDateCustomInput();null!==this.getCategoriesCustomInput()&&CustomSelect$1.create(e,this._dateName)};var Filters$1=Filters={_collection:{},init:function(e){if(this.isInitiated(e))throw new Error('Filter for form "'+e+'" already initiated!');var t=new Filter(e);this._collection[e]=t,t.initCategoriesCustomInput(),t.initDateCustomInput()},isInitiated:function(e){return void 0!==this._collection[e]},focusSearchInput:function(e){var t=this._collection[e],n=t.getSearchInput();n.focus()}},SubNavbar$1=SubNavbar={formFilterId:"activity_filters",btnShowMoreFiltersDataId:"show_more_filters",sectionFiltersId:"filters",classFilterActive:"active",init:function(){this.attachEventListeners()},attachEventListeners:function(){var e=this,t=this.getBtnsShowMoreFilters();t.forEach(function(t){t.addEventListener("click",function(){e.toggleMoreFilters()})})},getSectionFilters:function(){return document.getElementById(this.sectionFiltersId)},getBtnsShowMoreFilters:function(){return document.querySelectorAll('[data-id="'+this.btnShowMoreFiltersDataId+'"]')},toggleMoreFilters:function(){this.isMoreFiltersOpened()?this.hideMoreFilters():(Filters$1.isInitiated(this.formFilterId)||Filters$1.init(this.formFilterId),this.showMoreFilters())},isMoreFiltersOpened:function(){var e=this.getSectionFilters();return!e.hasAttribute("hidden")},showMoreFilters:function(){var e=this.getSectionFilters();e.removeAttribute("hidden")},hideMoreFilters:function(){var e=this.getSectionFilters();e.setAttribute("hidden","")}};document.addEventListener("DOMContentLoaded",function(){SubNavbar$1.init()});var AlertLegal={el:document.getElementById("alert_legal"),closeEl:document.getElementById("alert_legal_close"),closedKey:"app_legal_closed",removeFromDOM:function(){document.body.removeChild(this.el)},storeClosed:function(){var e=new Date;e.setFullYear(e.getFullYear()+1),document.cookie=this.closedKey+"=1; expires="+e.toUTCString()+"; path=/"},close:function(){this.storeClosed(),this.removeFromDOM()},attachCloseEvent:function(){var e=this;this.closeEl.addEventListener("click",function(){e.close()})},init:function(){null!==this.el&&this.attachCloseEvent()}};document.addEventListener("DOMContentLoaded",function(){AlertLegal.init()});var ScrollToTop$1=ScrollToTop={id:"scroll_top",init:function(){this._attachEventListeners()},getBtn:function(){return document.getElementById(this.id)},scrollTop:function(){Element.scrollTo(document.body)},_attachEventListeners:function(){var e=this,t=this.getBtn();null!==t&&t.addEventListener("click",function(){e.scrollTop()})}};document.addEventListener("DOMContentLoaded",function(){ScrollToTop$1.init()});